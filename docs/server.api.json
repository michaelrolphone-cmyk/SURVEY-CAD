{
  "openapi": "3.1.0",
  "info": {
    "title": "SURVEY-CAD Server API",
    "version": "1.0.0",
    "description": "OpenAPI spec generated from the provided SURVEY-CAD Server API Reference.\n\nBase URL default: http://0.0.0.0:3000\n\nConventions:\n- JSON responses: application/json; charset=utf-8\n- Errors: { \"error\": \"<message>\" }\n- Mutations typically return 201; reads return 200\n- Unsupported methods return 405"
  },
  "servers": [
    {
      "url": "http://0.0.0.0:3000",
      "description": "Default dev server"
    },
    {
      "url": "http://{host}:{port}",
      "description": "Configurable server",
      "variables": {
        "host": {
          "default": "0.0.0.0"
        },
        "port": {
          "default": "3000"
        }
      }
    }
  ],
  "tags": [
    {
      "name": "Health",
      "description": "Health checks"
    },
    {
      "name": "Apps",
      "description": "Application catalog"
    },
    {
      "name": "GIS",
      "description": "Geographic lookup and GIS operations"
    },
    {
      "name": "Project Files",
      "description": "Project file manifest and uploads"
    },
    {
      "name": "Crew",
      "description": "Crew management"
    },
    {
      "name": "Equipment",
      "description": "Equipment inventory"
    },
    {
      "name": "Equipment Logs",
      "description": "Equipment logs"
    },
    {
      "name": "LocalStorage Sync",
      "description": "Synchronized state snapshot (REST)"
    },
    {
      "name": "PointForge",
      "description": "PointForge exports"
    },
    {
      "name": "FLD",
      "description": "FLD configuration parsing"
    },
    {
      "name": "Worker",
      "description": "Distributed worker task management"
    },
    {
      "name": "ROS OCR",
      "description": "Record of Survey OCR extraction"
    },
    {
      "name": "Static Map",
      "description": "Static map tile proxy/fallback"
    },
    {
      "name": "ROS PDF Proxy",
      "description": "PDF proxy to avoid CORS"
    },
    {
      "name": "LineSmith Drawings",
      "description": "Project-scoped LineSmith drawing CRUD"
    },
    {
      "name": "Project Point Files",
      "description": "Project-scoped point file CRUD for PointForge/EvidenceDesk"
    },
    {
      "name": "CP&F Records",
      "description": "Project-scoped Corner Perpetuation & Filing record CRUD"
    },
    {
      "name": "Map Tiles",
      "description": "TileJSON and XYZ GeoJSON tile access from harvested MinIO buckets"
    },
    {
      "name": "RecordQuarry Cache",
      "description": "Server-side caching of RecordQuarry lookup results, keyed by project ID or normalized address. Avoids re-running the full GIS search on every open."
    },
    {
      "name": "RecordQuarry",
      "description": "RecordQuarry helper endpoints."
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "Health check",
        "operationId": "getHealth",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/apps": {
      "get": {
        "tags": [
          "Apps"
        ],
        "summary": "Get public application catalog",
        "operationId": "getApps",
        "responses": {
          "200": {
            "description": "Catalog",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppCatalogResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/lookup": {
      "get": {
        "tags": [
          "GIS"
        ],
        "summary": "Comprehensive address lookup",
        "description": "Geocodes the address and queries parcels, sections, subdivisions, and Records of Survey in the vicinity.\n\nResponse is the full result object from SurveyCadClient.lookupByAddress().",
        "operationId": "lookupByAddress",
        "parameters": [
          {
            "$ref": "#/components/parameters/addressRequired"
          }
        ],
        "responses": {
          "200": {
            "description": "Lookup result (implementation-defined payload)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LookupResult"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/geocode": {
      "get": {
        "tags": [
          "GIS"
        ],
        "summary": "Geocode an address",
        "description": "Tries Nominatim first, falls back to ArcGIS.",
        "operationId": "geocodeAddress",
        "parameters": [
          {
            "$ref": "#/components/parameters/addressRequired"
          }
        ],
        "responses": {
          "200": {
            "description": "Geocode result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GeocodeResult"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/parcel": {
      "get": {
        "tags": [
          "GIS"
        ],
        "summary": "Find nearest parcel to a point",
        "operationId": "getNearestParcel",
        "parameters": [
          {
            "$ref": "#/components/parameters/lonRequired"
          },
          {
            "$ref": "#/components/parameters/latRequired"
          },
          {
            "$ref": "#/components/parameters/outSR4326"
          },
          {
            "$ref": "#/components/parameters/searchMeters40"
          }
        ],
        "responses": {
          "200": {
            "description": "Nearest parcel feature",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ParcelResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/section": {
      "get": {
        "tags": [
          "GIS"
        ],
        "summary": "Load PLSS section at a point",
        "operationId": "getSectionAtPoint",
        "parameters": [
          {
            "$ref": "#/components/parameters/lonRequired"
          },
          {
            "$ref": "#/components/parameters/latRequired"
          }
        ],
        "responses": {
          "200": {
            "description": "Section feature or null",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SectionResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/aliquots": {
      "get": {
        "tags": [
          "GIS"
        ],
        "summary": "Load PLSS aliquots within the containing section",
        "operationId": "getAliquotsAtPoint",
        "parameters": [
          {
            "$ref": "#/components/parameters/lonRequired"
          },
          {
            "$ref": "#/components/parameters/latRequired"
          },
          {
            "$ref": "#/components/parameters/outSR4326"
          }
        ],
        "responses": {
          "200": {
            "description": "Aliquots in the section",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AliquotsResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/subdivision": {
      "get": {
        "tags": [
          "GIS"
        ],
        "summary": "Load subdivision data at a point",
        "operationId": "getSubdivisionAtPoint",
        "parameters": [
          {
            "$ref": "#/components/parameters/lonRequired"
          },
          {
            "$ref": "#/components/parameters/latRequired"
          },
          {
            "$ref": "#/components/parameters/outSR4326"
          }
        ],
        "responses": {
          "200": {
            "description": "Subdivision feature (or null, implementation-defined)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SubdivisionResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/utilities": {
      "get": {
        "tags": [
          "GIS"
        ],
        "summary": "Look up utility records near an address",
        "operationId": "getUtilitiesNearAddress",
        "parameters": [
          {
            "$ref": "#/components/parameters/addressRequired"
          },
          {
            "$ref": "#/components/parameters/outSR2243"
          },
          {
            "$ref": "#/components/parameters/sourcesPower"
          }
        ],
        "responses": {
          "200": {
            "description": "Utility records",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UtilitiesResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/project-file/template": {
      "get": {
        "tags": [
          "Project Files"
        ],
        "summary": "Generate a project file manifest template",
        "operationId": "getProjectFileTemplate",
        "parameters": [
          {
            "$ref": "#/components/parameters/projectIdOptional"
          },
          {
            "$ref": "#/components/parameters/projectNameOptional"
          },
          {
            "$ref": "#/components/parameters/clientOptional"
          },
          {
            "$ref": "#/components/parameters/addressOptional"
          },
          {
            "$ref": "#/components/parameters/resourcesJsonOptional"
          }
        ],
        "responses": {
          "200": {
            "description": "Template manifest",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectFileTemplateResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/project-file/compile": {
      "post": {
        "tags": [
          "Project Files"
        ],
        "summary": "Compile a project file into an archive plan",
        "operationId": "compileProjectFile",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CompileProjectFileRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Compiled archive plan",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CompileProjectFileResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/project-files/upload": {
      "post": {
        "tags": [
          "Project Files"
        ],
        "summary": "Upload a file to a project folder on the server",
        "operationId": "uploadProjectFile",
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "projectId",
                  "folderKey",
                  "file"
                ],
                "properties": {
                  "projectId": {
                    "type": "string"
                  },
                  "folderKey": {
                    "$ref": "#/components/schemas/FolderKey"
                  },
                  "file": {
                    "type": "string",
                    "format": "binary"
                  },
                  "rosNumber": {
                    "type": "string",
                    "description": "Optional ROS map number to associate with uploaded PDF evidence for LineSmith point-inspector linking."
                  },
                  "pointNumber": {
                    "type": "string",
                    "description": "Optional point number for image/photo lookup links in LineSmith."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Uploaded resource record",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadProjectFileResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "403": {
            "$ref": "#/components/responses/Error403"
          },
          "413": {
            "description": "Declared upload payload is larger than the server maximum.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "507": {
            "$ref": "#/components/responses/Error507"
          }
        }
      },
      "put": {
        "tags": [
          "Project Files"
        ],
        "summary": "Update an uploaded file in a project folder",
        "operationId": "updateProjectFileUpload",
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "projectId",
                  "folderKey",
                  "fileName",
                  "file"
                ],
                "properties": {
                  "projectId": {
                    "type": "string"
                  },
                  "folderKey": {
                    "$ref": "#/components/schemas/FolderKey"
                  },
                  "fileName": {
                    "type": "string"
                  },
                  "file": {
                    "type": "string",
                    "format": "binary"
                  },
                  "rosNumber": {
                    "type": "string",
                    "description": "Optional ROS map number to associate with uploaded PDF evidence for LineSmith point-inspector linking."
                  },
                  "pointNumber": {
                    "type": "string",
                    "description": "Optional point number for image/photo lookup links in LineSmith."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated resource record",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UploadProjectFileResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          },
          "413": {
            "description": "Declared upload payload is larger than the server maximum.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "507": {
            "$ref": "#/components/responses/Error507"
          }
        }
      }
    },
    "/api/project-files/download": {
      "get": {
        "tags": [
          "Project Files"
        ],
        "summary": "Download a previously uploaded file",
        "operationId": "downloadProjectFile",
        "parameters": [
          {
            "$ref": "#/components/parameters/projectIdRequired"
          },
          {
            "$ref": "#/components/parameters/folderKeyRequired"
          },
          {
            "$ref": "#/components/parameters/fileNameRequired"
          }
        ],
        "responses": {
          "200": {
            "description": "Raw file content (content-type varies)",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/project-files/list": {
      "get": {
        "tags": [
          "Project Files"
        ],
        "summary": "List all uploaded files for a project",
        "operationId": "listProjectFiles",
        "parameters": [
          {
            "$ref": "#/components/parameters/projectIdRequired"
          }
        ],
        "responses": {
          "200": {
            "description": "List of stored file entries",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectFilesListResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/crew": {
      "get": {
        "tags": [
          "Crew"
        ],
        "summary": "List all crew members or retrieve one by ID",
        "operationId": "getCrew",
        "parameters": [
          {
            "$ref": "#/components/parameters/idOptional"
          }
        ],
        "responses": {
          "200": {
            "description": "Crew list or single member",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/CrewListResponse"
                    },
                    {
                      "$ref": "#/components/schemas/CrewMemberResponse"
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "post": {
        "tags": [
          "Crew"
        ],
        "summary": "Create or update a crew member",
        "description": "Automatically broadcasts the change to all connected LocalStorage Sync WebSocket clients. New crew records require firstName or lastName. Existing records can also be updated by sending id plus lineSmithActiveDrawingByProject.",
        "operationId": "upsertCrewMember",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CrewMemberUpsert"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Upserted crew member",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CrewMemberResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/crew-presence": {
      "get": {
        "tags": [
          "Crew"
        ],
        "summary": "Get currently online crew member IDs",
        "operationId": "getCrewPresence",
        "responses": {
          "200": {
            "description": "Online IDs",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CrewPresenceResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/equipment": {
      "get": {
        "tags": [
          "Equipment"
        ],
        "summary": "List all equipment or retrieve one by ID",
        "operationId": "getEquipment",
        "parameters": [
          {
            "$ref": "#/components/parameters/idOptional"
          }
        ],
        "responses": {
          "200": {
            "description": "Equipment list or single equipment",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/EquipmentListResponse"
                    },
                    {
                      "$ref": "#/components/schemas/EquipmentResponse"
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "post": {
        "tags": [
          "Equipment"
        ],
        "summary": "Create or update an equipment item",
        "operationId": "upsertEquipment",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EquipmentUpsert"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Upserted equipment item",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EquipmentResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "delete": {
        "tags": [
          "Equipment"
        ],
        "summary": "Delete an equipment item by ID",
        "operationId": "deleteEquipment",
        "parameters": [
          {
            "name": "id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Equipment item ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Deleted equipment item result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "deleted",
                    "id"
                  ],
                  "properties": {
                    "deleted": {
                      "type": "boolean",
                      "enum": [
                        true
                      ]
                    },
                    "id": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/equipment-logs": {
      "get": {
        "tags": [
          "Equipment Logs"
        ],
        "summary": "List all equipment logs or retrieve one by ID",
        "operationId": "getEquipmentLogs",
        "parameters": [
          {
            "$ref": "#/components/parameters/idOptional"
          }
        ],
        "responses": {
          "200": {
            "description": "Log list or single log",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/EquipmentLogListResponse"
                    },
                    {
                      "$ref": "#/components/schemas/EquipmentLogResponse"
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "post": {
        "tags": [
          "Equipment Logs"
        ],
        "summary": "Create or update an equipment log entry (optionally linked to a project point file)",
        "operationId": "upsertEquipmentLog",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EquipmentLogUpsert"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Upserted equipment log",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EquipmentLogResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        },
        "description": "Stores equipment log metadata and optional point-file linkage fields (pointFileId, pointFileName, pointFileProjectId)."
      }
    },
    "/api/localstorage-sync": {
      "get": {
        "tags": [
          "LocalStorage Sync"
        ],
        "summary": "Get current synchronized state snapshot",
        "operationId": "getLocalStorageSyncState",
        "responses": {
          "200": {
            "description": "State snapshot",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncState"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "LocalStorage Sync"
        ],
        "summary": "Push full state snapshot (full sync)",
        "operationId": "postLocalStorageSyncState",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SyncStatePushRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Sync status and authoritative server state",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SyncStatePushResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/pointforge-exports": {
      "get": {
        "tags": [
          "PointForge"
        ],
        "summary": "List PointForge exports or retrieve one by ID",
        "operationId": "getPointForgeExports",
        "parameters": [
          {
            "$ref": "#/components/parameters/idOptional"
          },
          {
            "$ref": "#/components/parameters/roomDefault"
          }
        ],
        "responses": {
          "200": {
            "description": "Export list or single export",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/PointForgeExportListResponse"
                    },
                    {
                      "$ref": "#/components/schemas/PointForgeExportResponse"
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "post": {
        "tags": [
          "PointForge"
        ],
        "summary": "Create a PointForge export and broadcast to LineForge room",
        "description": "Side effect: broadcasts a `pointforge-import` event to the LineForge collaboration room.",
        "operationId": "createPointForgeExport",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PointForgeExportCreateRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Created export",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PointForgeExportResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/fld-config": {
      "get": {
        "tags": [
          "FLD"
        ],
        "summary": "Load and parse a .fld configuration file",
        "operationId": "getFldConfig",
        "parameters": [
          {
            "$ref": "#/components/parameters/fileDefaultFld"
          }
        ],
        "responses": {
          "200": {
            "description": "Parsed FLD config",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FldConfig"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/worker/submit": {
      "post": {
        "tags": [
          "Worker"
        ],
        "summary": "Submit a task to the worker pool (blocking)",
        "operationId": "submitWorkerTask",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WorkerSubmitRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Task completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WorkerSubmitSuccessResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "500": {
            "description": "Task failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WorkerSubmitFailureResponse"
                }
              }
            }
          },
          "503": {
            "description": "No online workers in pool",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NoWorkersResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/worker/workers": {
      "get": {
        "tags": [
          "Worker"
        ],
        "summary": "List registered workers and status",
        "operationId": "listWorkers",
        "parameters": [
          {
            "$ref": "#/components/parameters/poolDefault"
          }
        ],
        "responses": {
          "200": {
            "description": "Workers",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WorkerWorkersResponse"
                }
              }
            }
          }
        }
      }
    },
    "/extract": {
      "post": {
        "tags": [
          "ROS OCR"
        ],
        "summary": "Extract basis-of-bearing candidates from a RoS PDF via OCR",
        "operationId": "extractRosBasisCandidates",
        "parameters": [
          {
            "$ref": "#/components/parameters/maxPages1"
          },
          {
            "$ref": "#/components/parameters/dpi220"
          },
          {
            "$ref": "#/components/parameters/async01"
          },
          {
            "$ref": "#/components/parameters/allowSlow01"
          },
          {
            "$ref": "#/components/parameters/debug01"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "pdf"
                ],
                "properties": {
                  "pdf": {
                    "type": "string",
                    "format": "binary",
                    "description": "PDF file to process (max 35 MB)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Synchronous extraction result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExtractSyncResponse"
                }
              }
            }
          },
          "202": {
            "description": "Async job queued",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExtractAsyncResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/extract/jobs/{jobId}": {
      "get": {
        "tags": [
          "ROS OCR"
        ],
        "summary": "Poll an async extraction job status",
        "operationId": "getExtractJobStatus",
        "parameters": [
          {
            "name": "jobId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Job status (running or completed)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/ExtractJobRunningResponse"
                    },
                    {
                      "$ref": "#/components/schemas/ExtractJobCompletedResponse"
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Job failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExtractJobFailedResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/static-map": {
      "get": {
        "tags": [
          "Static Map"
        ],
        "summary": "Fetch a satellite/street map tile centered on coordinates",
        "description": "Attempts ArcGIS World Imagery first, falls back to OpenStreetMap, then to a generated SVG placeholder.",
        "operationId": "getStaticMapTile",
        "parameters": [
          {
            "$ref": "#/components/parameters/lonRequired"
          },
          {
            "$ref": "#/components/parameters/latRequired"
          },
          {
            "name": "address",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Address label used for SVG fallback"
          }
        ],
        "responses": {
          "200": {
            "description": "Map tile image (png) or fallback SVG",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "image/svg+xml": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/ros-pdf": {
      "get": {
        "tags": [
          "ROS PDF Proxy"
        ],
        "summary": "Proxy a remote Record of Survey PDF (avoid CORS)",
        "operationId": "proxyRosPdf",
        "parameters": [
          {
            "name": "url",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uri"
            },
            "description": "Absolute HTTP/HTTPS URL to the PDF"
          }
        ],
        "responses": {
          "200": {
            "description": "Raw PDF content with upstream headers",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              },
              "application/octet-stream": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "502": {
            "$ref": "#/components/responses/Error502"
          }
        }
      }
    },
    "/api/projects/{projectId}/drawings": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": [
          "LineSmith Drawings"
        ],
        "summary": "List project drawings",
        "operationId": "listProjectDrawings",
        "responses": {
          "200": {
            "description": "Drawing summaries for the project",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LineSmithDrawingListResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "post": {
        "tags": [
          "LineSmith Drawings"
        ],
        "summary": "Create project drawing",
        "operationId": "createProjectDrawing",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LineSmithDrawingMutationRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Drawing created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LineSmithDrawingResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/projects/{projectId}/drawings/{drawingId}": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "drawingId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": [
          "LineSmith Drawings"
        ],
        "summary": "Get project drawing",
        "operationId": "getProjectDrawing",
        "responses": {
          "200": {
            "description": "Drawing record",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LineSmithDrawingResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        },
        "description": "Returns the full drawing record. When linkedPointFileId is set, currentState.points is hydrated from the latest linked project point-file text so external point-file edits are reflected when LineSmith loads the drawing."
      },
      "put": {
        "tags": [
          "LineSmith Drawings"
        ],
        "summary": "Update project drawing (append differential version)",
        "operationId": "updateProjectDrawing",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LineSmithDrawingMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Drawing updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LineSmithDrawingResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "patch": {
        "tags": [
          "LineSmith Drawings"
        ],
        "summary": "Patch project drawing (append differential version)",
        "operationId": "patchProjectDrawing",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LineSmithDrawingMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Drawing updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LineSmithDrawingResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "delete": {
        "tags": [
          "LineSmith Drawings"
        ],
        "summary": "Delete project drawing",
        "operationId": "deleteProjectDrawing",
        "responses": {
          "200": {
            "description": "Delete status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LineSmithDrawingDeleteResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/projects/{projectId}/point-files": {
      "get": {
        "tags": [
          "Project Point Files"
        ],
        "summary": "List project point files",
        "operationId": "listProjectPointFiles",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Point file summaries",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPointFileListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Project Point Files"
        ],
        "summary": "Create project point file",
        "operationId": "createProjectPointFile",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectPointFileMutationRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPointFileResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/point-files/{pointFileId}": {
      "get": {
        "tags": [
          "Project Point Files"
        ],
        "summary": "Get project point file",
        "operationId": "getProjectPointFile",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pointFileId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "versionId",
            "in": "query",
            "required": false,
            "description": "Optional point-file version identifier. When provided, currentState is reconstructed at that version.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Point file",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPointFileResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Project Point Files"
        ],
        "summary": "Update project point file (append differential version)",
        "operationId": "updateProjectPointFile",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pointFileId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectPointFileMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPointFileResponse"
                }
              }
            }
          }
        }
      },
      "patch": {
        "tags": [
          "Project Point Files"
        ],
        "summary": "Patch project point file (append differential version)",
        "operationId": "patchProjectPointFile",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pointFileId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectPointFileMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPointFileResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Project Point Files"
        ],
        "summary": "Delete project point file",
        "operationId": "deleteProjectPointFile",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pointFileId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/archive": {
      "post": {
        "tags": [
          "Project Archives"
        ],
        "summary": "Archive project delete payload to object storage",
        "operationId": "archiveProjectDelete",
        "parameters": [
          {
            "$ref": "#/components/parameters/ProjectIdParam"
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "project": {
                    "type": "object",
                    "additionalProperties": true,
                    "description": "Optional launcher project metadata snapshot saved with the archive record."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Project archive captured.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "archived",
                    "projectId",
                    "snapshotEntryCount",
                    "redisEntryCount"
                  ],
                  "properties": {
                    "archived": {
                      "type": "boolean"
                    },
                    "projectId": {
                      "type": "string"
                    },
                    "snapshotEntryCount": {
                      "type": "integer"
                    },
                    "redisEntryCount": {
                      "type": "integer"
                    },
                    "archiveResource": {
                      "type": "object",
                      "additionalProperties": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/projects/{projectId}/cpfs": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "Project ID"
        }
      ],
      "get": {
        "tags": [
          "CP&F Records"
        ],
        "summary": "List project CP&F records",
        "description": "Returns all CP&F records for the project sorted by updatedAt descending.",
        "operationId": "listProjectCpfs",
        "responses": {
          "200": {
            "description": "CP&F record list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectCpfListResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "post": {
        "tags": [
          "CP&F Records"
        ],
        "summary": "Create or batch-upsert CP&F record(s)",
        "description": "Accepts either a single record body (`{ instrument, ... }`) or a batch body (`{ cpfs: [...] }`).\n\n- **Single**: creates a new record or upserts an existing one by derived `cpfId`. Returns `201` for new, `200` for updated.\n- **Batch**: all entries are upserted atomically. Always returns `200`. Entries missing `instrument` are silently skipped.",
        "operationId": "createOrBatchUpsertProjectCpfs",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  {
                    "$ref": "#/components/schemas/ProjectCpfMutationRequest"
                  },
                  {
                    "$ref": "#/components/schemas/ProjectCpfBatchUpsertRequest"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Batch upsert result or single upsert of existing record",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/ProjectCpfResponse"
                    },
                    {
                      "$ref": "#/components/schemas/ProjectCpfBatchUpsertResponse"
                    }
                  ]
                }
              }
            }
          },
          "201": {
            "description": "Single CP&F record created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectCpfResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/projects/{projectId}/cpfs/{cpfId}": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "Project ID"
        },
        {
          "name": "cpfId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "Slugified instrument number (e.g. `2024-123456`)"
        }
      ],
      "get": {
        "tags": [
          "CP&F Records"
        ],
        "summary": "Get a single CP&F record",
        "operationId": "getProjectCpf",
        "responses": {
          "200": {
            "description": "CP&F record",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectCpfResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "put": {
        "tags": [
          "CP&F Records"
        ],
        "summary": "Update (upsert) a CP&F record",
        "description": "Updates the record identified by `cpfId`. Acts as upsert \u2014 creates the record if it does not exist. Returns `200` for update, `201` for create.",
        "operationId": "updateProjectCpf",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectCpfMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "CP&F record updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectCpfResponse"
                }
              }
            }
          },
          "201": {
            "description": "CP&F record created via upsert",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectCpfResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "patch": {
        "tags": [
          "CP&F Records"
        ],
        "summary": "Patch (upsert) a CP&F record",
        "description": "Identical behaviour to `PUT`. Updates the record identified by `cpfId`, or creates it if absent.",
        "operationId": "patchProjectCpf",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectCpfMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "CP&F record updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectCpfResponse"
                }
              }
            }
          },
          "201": {
            "description": "CP&F record created via upsert",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectCpfResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "delete": {
        "tags": [
          "CP&F Records"
        ],
        "summary": "Delete a CP&F record",
        "operationId": "deleteProjectCpf",
        "responses": {
          "200": {
            "description": "Record deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "deleted"
                  ]
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/projects/{projectId}/record-quarry-cache": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "Project ID"
        }
      ],
      "get": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Get cached RecordQuarry results for a project",
        "description": "Returns the most recently saved lookup snapshot for this project. Returns 404 if no cache exists yet.",
        "operationId": "getProjectRecordQuarryCache",
        "responses": {
          "200": {
            "description": "Cached lookup snapshot",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cache": {
                      "$ref": "#/components/schemas/RecordQuarryCacheRecord"
                    }
                  },
                  "required": [
                    "cache"
                  ]
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "put": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Save (upsert) RecordQuarry results for a project",
        "description": "Stores the lookup snapshot for this project. Overwrites any previously cached results.",
        "operationId": "saveProjectRecordQuarryCache",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecordQuarryCacheInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cache saved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cache": {
                      "$ref": "#/components/schemas/RecordQuarryCacheRecord"
                    }
                  },
                  "required": [
                    "cache"
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "post": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Save (upsert) RecordQuarry results for a project (POST alias)",
        "description": "Identical behaviour to `PUT`. Provided for clients that prefer POST for creates.",
        "operationId": "saveProjectRecordQuarryCachePost",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecordQuarryCacheInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cache saved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cache": {
                      "$ref": "#/components/schemas/RecordQuarryCacheRecord"
                    }
                  },
                  "required": [
                    "cache"
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "delete": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Delete cached RecordQuarry results for a project",
        "operationId": "deleteProjectRecordQuarryCache",
        "responses": {
          "200": {
            "description": "Cache deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "deleted"
                  ]
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/record-quarry-cache": {
      "get": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Get cached RecordQuarry results for an address",
        "description": "Returns the cached lookup snapshot for the given normalized address. The `address` parameter is lowercased and whitespace-collapsed before lookup.",
        "operationId": "getAddressRecordQuarryCache",
        "parameters": [
          {
            "name": "address",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Normalized address string (e.g. \"123 main st\")"
          }
        ],
        "responses": {
          "200": {
            "description": "Cached lookup snapshot",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cache": {
                      "$ref": "#/components/schemas/RecordQuarryCacheRecord"
                    }
                  },
                  "required": [
                    "cache"
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "put": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Save (upsert) RecordQuarry results for an address",
        "description": "Stores the lookup snapshot keyed by normalized address. The `address` query parameter takes precedence; if omitted the `address` field in the request body is used instead.",
        "operationId": "saveAddressRecordQuarryCache",
        "parameters": [
          {
            "name": "address",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Normalized address string. If omitted, the `address` field in the request body is used."
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecordQuarryCacheInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cache saved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cache": {
                      "$ref": "#/components/schemas/RecordQuarryCacheRecord"
                    }
                  },
                  "required": [
                    "cache"
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "post": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Save (upsert) RecordQuarry results for an address (POST alias)",
        "description": "Identical behaviour to `PUT`.",
        "operationId": "saveAddressRecordQuarryCachePost",
        "parameters": [
          {
            "name": "address",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Normalized address string. If omitted, the `address` field in the request body is used."
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RecordQuarryCacheInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cache saved",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "cache": {
                      "$ref": "#/components/schemas/RecordQuarryCacheRecord"
                    }
                  },
                  "required": [
                    "cache"
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "delete": {
        "tags": [
          "RecordQuarry Cache"
        ],
        "summary": "Delete cached RecordQuarry results for an address",
        "operationId": "deleteAddressRecordQuarryCache",
        "parameters": [
          {
            "name": "address",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Normalized address string"
          }
        ],
        "responses": {
          "200": {
            "description": "Cache deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "deleted"
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/projects/{projectId}/workbench": {
      "get": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "Get project linked Workbench casefile",
        "operationId": "getProjectWorkbench",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Project link and linked casefile",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchLinkResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "Create or sync project-linked Workbench casefile (root alias)",
        "description": "Convenience endpoint that behaves like `POST /api/projects/{projectId}/workbench/sync` by default, and can force casefile creation with request flags.",
        "operationId": "syncProjectWorkbenchRoot",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectWorkbenchSyncRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Linked casefile with sync summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchSyncResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/workbench/link": {
      "put": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "Link an existing Workbench casefile to project",
        "operationId": "setProjectWorkbenchLink",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectWorkbenchLinkMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Link updated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "projectId": {
                      "type": "string"
                    },
                    "link": {
                      "$ref": "#/components/schemas/ProjectWorkbenchLink"
                    }
                  },
                  "required": [
                    "projectId",
                    "link"
                  ]
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "Unlink Workbench casefile from project",
        "operationId": "deleteProjectWorkbenchLink",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Link delete status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchDeleteResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/workbench/casefile": {
      "post": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "Create linked casefile and sync project evidence",
        "operationId": "createProjectWorkbenchCasefile",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Linked casefile with sync summary",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchSyncResponse"
                }
              }
            }
          }
        },
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectWorkbenchSyncRequest"
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "Delete linked casefile and unlink project",
        "operationId": "deleteProjectWorkbenchCasefile",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Delete status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchDeleteResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/projects/{projectId}/workbench/sources": {
      "get": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "List project-derived Workbench evidence sources",
        "operationId": "listProjectWorkbenchSources",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Derived source list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchSourcesResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/workbench/sync": {
      "post": {
        "tags": [
          "Project Workbench"
        ],
        "summary": "Sync project-derived evidence into linked casefile",
        "operationId": "syncProjectWorkbench",
        "parameters": [
          {
            "name": "projectId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Sync result",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchSyncResponse"
                }
              }
            }
          }
        },
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectWorkbenchSyncRequest"
              }
            }
          }
        }
      }
    },
    "/api/glo-records": {
      "get": {
        "tags": [
          "Lookup"
        ],
        "summary": "Fetch BLM GLO documents by address or coordinates",
        "parameters": [
          {
            "in": "query",
            "name": "address",
            "required": false,
            "description": "Project address used to resolve township/range/section metadata.",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "lon",
            "required": false,
            "description": "Longitude in WGS84. Provide with lat when address is omitted.",
            "schema": {
              "type": "number"
            }
          },
          {
            "in": "query",
            "name": "lat",
            "required": false,
            "description": "Latitude in WGS84. Provide with lon when address is omitted.",
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "GLO records lookup response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GloRecordsResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/workbench/traverses": {
      "get": {
        "summary": "List BoundaryLab traverses saved for a project",
        "operationId": "listProjectTraverses",
        "tags": [
          "Project Workbench"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ProjectIdPath"
          }
        ],
        "responses": {
          "200": {
            "description": "Project traverse list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchTraverseListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create or update a project traverse using Workbench traverse storage",
        "operationId": "upsertProjectTraverse",
        "tags": [
          "Project Workbench"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ProjectIdPath"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectWorkbenchTraverseUpsertRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated traverse",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchTraverseResponse"
                }
              }
            }
          },
          "201": {
            "description": "Created traverse",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchTraverseResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/workbench/traverses/{traverseId}": {
      "get": {
        "summary": "Load a saved project traverse with traverse config",
        "operationId": "getProjectTraverse",
        "tags": [
          "Project Workbench"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/ProjectIdPath"
          },
          {
            "$ref": "#/components/parameters/TraverseIdPath"
          }
        ],
        "responses": {
          "200": {
            "description": "Project traverse",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectWorkbenchTraverseLoadResponse"
                }
              }
            }
          },
          "404": {
            "description": "Traverse not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/field-to-finish": {
      "get": {
        "tags": [
          "FLD"
        ],
        "summary": "Get shared LineSmith field-to-finish settings",
        "responses": {
          "200": {
            "description": "Shared settings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FieldToFinishSettingsResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "FLD"
        ],
        "summary": "Create or update shared LineSmith field-to-finish settings",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FieldToFinishSettingsMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated settings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FieldToFinishSettingsResponse"
                }
              }
            }
          },
          "201": {
            "description": "Created settings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FieldToFinishSettingsResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "FLD"
        ],
        "summary": "Reset shared LineSmith field-to-finish settings to server defaults",
        "responses": {
          "200": {
            "description": "Deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "deleted"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "No shared settings record to delete"
          }
        }
      }
    },
    "/api/project-files/file": {
      "delete": {
        "tags": [
          "Project Files"
        ],
        "summary": "Delete a previously uploaded file",
        "operationId": "deleteProjectFileUpload",
        "parameters": [
          {
            "$ref": "#/components/parameters/projectIdRequired"
          },
          {
            "$ref": "#/components/parameters/folderKeyRequired"
          },
          {
            "$ref": "#/components/parameters/fileNameRequired"
          }
        ],
        "responses": {
          "200": {
            "description": "Delete status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "deleted"
                  ],
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "patch": {
        "tags": [
          "Project Files"
        ],
        "summary": "Move a previously uploaded file to another project folder",
        "operationId": "moveProjectFileUpload",
        "parameters": [
          {
            "$ref": "#/components/parameters/projectIdRequired"
          },
          {
            "$ref": "#/components/parameters/folderKeyRequired"
          },
          {
            "$ref": "#/components/parameters/fileNameRequired"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "targetFolderKey"
                ],
                "properties": {
                  "targetFolderKey": {
                    "type": "string"
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Move status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "moved",
                    "resource"
                  ],
                  "properties": {
                    "moved": {
                      "type": "boolean"
                    },
                    "resource": {
                      "$ref": "#/components/schemas/ProjectFileResource"
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/project-files/pdf-thumbnail": {
      "get": {
        "tags": [
          "Project Files"
        ],
        "summary": "Get or trigger generation of a cached PDF page-1 thumbnail.",
        "parameters": [
          {
            "name": "source",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Relative source URL for a PDF endpoint (/api/project-files/download... or /api/ros-pdf...)."
          }
        ],
        "responses": {
          "200": {
            "description": "PNG thumbnail image (1024px width target).",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "202": {
            "description": "Thumbnail generation in progress.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "source": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters."
          },
          "404": {
            "description": "Source PDF file was not found."
          },
          "405": {
            "description": "Method not allowed."
          },
          "502": {
            "description": "Thumbnail generation failed. Retry after cooldown.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "error",
                    "status",
                    "source"
                  ],
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "status": {
                      "type": "string",
                      "enum": [
                        "failed"
                      ]
                    },
                    "source": {
                      "type": "string"
                    },
                    "detail": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          }
        }
      }
    },
    "/api/project-files/image-thumbnail": {
      "get": {
        "tags": [
          "Project Files"
        ],
        "summary": "Download a generated image thumbnail for an uploaded file",
        "operationId": "getProjectFileImageThumbnail",
        "parameters": [
          {
            "name": "projectId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "folderKey",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "enum": [
                "drawings",
                "ros",
                "cpfs",
                "point-files",
                "deeds",
                "plats",
                "invoices",
                "other"
              ]
            }
          },
          {
            "name": "fileName",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "PNG thumbnail image (512px width target).",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "400": {
            "description": "Missing or invalid query parameters."
          },
          "404": {
            "description": "Thumbnail not found for file."
          }
        }
      }
    },
    "/api/project-files/metadata": {
      "patch": {
        "tags": [
          "Project Files"
        ],
        "summary": "Update project upload metadata fields",
        "operationId": "patchProjectFileMetadata",
        "parameters": [
          {
            "name": "projectId",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "folderKey",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "fileName",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "rosNumber": {
                    "type": "string",
                    "description": "Optional ROS number metadata."
                  },
                  "pointNumber": {
                    "type": "string",
                    "description": "Optional point number metadata for uploaded photos."
                  }
                },
                "additionalProperties": false,
                "minProperties": 1
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Metadata updated successfully."
          },
          "400": {
            "description": "Missing query parameters or invalid request body."
          },
          "404": {
            "description": "File not found."
          }
        }
      }
    },
    "/api/idaho-harvest/status": {
      "get": {
        "tags": [
          "Worker"
        ],
        "summary": "Get Idaho parcel/CPNF harvest worker status",
        "operationId": "getIdahoHarvestStatus",
        "responses": {
          "200": {
            "description": "Worker status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdahoHarvestStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/idaho-harvest/start": {
      "post": {
        "tags": [
          "Worker"
        ],
        "summary": "Start Idaho parcel/CPNF harvest worker",
        "operationId": "startIdahoHarvestWorker",
        "responses": {
          "202": {
            "description": "Worker start accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdahoHarvestStatusResponse"
                }
              }
            }
          },
          "403": {
            "description": "Workers disabled by configuration",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/idaho-harvest/stop": {
      "post": {
        "tags": [
          "Worker"
        ],
        "summary": "Stop Idaho parcel/CPNF harvest worker",
        "operationId": "stopIdahoHarvestWorker",
        "responses": {
          "202": {
            "description": "Worker stop accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/IdahoHarvestStatusResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/maptiles": {
      "get": {
        "tags": [
          "Map Tiles"
        ],
        "summary": "List exposed map tile datasets",
        "responses": {
          "200": {
            "description": "Dataset list with TileJSON and tile URL templates",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "datasets": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "dataset": {
                            "type": "string"
                          },
                          "tilejson": {
                            "type": "string"
                          },
                          "tiles": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "dataset",
                          "tilejson",
                          "tiles"
                        ]
                      }
                    }
                  },
                  "required": [
                    "datasets"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/maptiles/{dataset}/tilejson.json": {
      "get": {
        "tags": [
          "Map Tiles"
        ],
        "summary": "Get TileJSON for a harvested tile dataset",
        "parameters": [
          {
            "in": "path",
            "name": "dataset",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Tile dataset key (for example parcels-layer-24 or cpnf-layer-18)"
          }
        ],
        "responses": {
          "200": {
            "description": "TileJSON document",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "tilejson": {
                      "type": "string",
                      "example": "3.0.0"
                    },
                    "name": {
                      "type": "string"
                    },
                    "scheme": {
                      "type": "string",
                      "example": "xyz"
                    },
                    "tiles": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "minzoom": {
                      "type": "integer"
                    },
                    "maxzoom": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "tilejson",
                    "name",
                    "scheme",
                    "tiles",
                    "minzoom",
                    "maxzoom"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Dataset not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/maptiles/{dataset}/{z}/{x}/{y}.geojson": {
      "get": {
        "tags": [
          "Map Tiles"
        ],
        "summary": "Fetch a harvested GeoJSON XYZ tile from object storage",
        "parameters": [
          {
            "in": "path",
            "name": "dataset",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "z",
            "required": true,
            "schema": {
              "type": "integer",
              "minimum": 0
            }
          },
          {
            "in": "path",
            "name": "x",
            "required": true,
            "schema": {
              "type": "integer",
              "minimum": 0
            }
          },
          {
            "in": "path",
            "name": "y",
            "required": true,
            "schema": {
              "type": "integer",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "GeoJSON tile payload",
            "content": {
              "application/geo+json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          },
          "404": {
            "description": "Dataset or tile not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          },
          "503": {
            "description": "Tile object storage unavailable",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/project-files/ros-thumbnail": {
      "get": {
        "tags": [
          "Project Files"
        ],
        "summary": "Get or trigger generation of a cached ROS TIFF thumbnail.",
        "parameters": [
          {
            "name": "source",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Source URL for a ROS TIFF (/api/project-files/download... with .tif/.tiff or absolute http(s) .tif/.tiff URL)."
          }
        ],
        "responses": {
          "200": {
            "description": "PNG thumbnail image (1024px width target).",
            "content": {
              "image/png": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "202": {
            "description": "Thumbnail generation in progress.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "source": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters."
          },
          "404": {
            "description": "Source TIFF file was not found."
          },
          "405": {
            "description": "Method not allowed."
          },
          "502": {
            "description": "Thumbnail generation failed. Retry after cooldown.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "error",
                    "status",
                    "source"
                  ],
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "status": {
                      "type": "string",
                      "enum": [
                        "failed"
                      ]
                    },
                    "source": {
                      "type": "string"
                    },
                    "detail": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              }
            }
          }
        }
      }
    },
    "/api/projects/{projectId}/ros": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "Project ID"
        }
      ],
      "get": {
        "tags": [
          "ROS Records"
        ],
        "summary": "List project ROS records",
        "description": "Returns all ROS records for the project sorted by updatedAt descending.",
        "operationId": "listProjectRoss",
        "responses": {
          "200": {
            "description": "ROS record list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectRosListResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "post": {
        "tags": [
          "ROS Records"
        ],
        "summary": "Create or batch-upsert ROS record(s)",
        "description": "Accepts either a single record body (`{ rosNumber, ... }`) or a batch body (`{ ros: [...] }`).\n\n- **Single**: creates a new record or upserts an existing one by derived `rosId`. Returns `201` for new, `200` for updated.\n- **Batch**: all entries are upserted atomically. Always returns `200`. Entries missing `rosNumber` are silently skipped.",
        "operationId": "createOrBatchUpsertProjectRoss",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  {
                    "$ref": "#/components/schemas/ProjectRosMutationRequest"
                  },
                  {
                    "$ref": "#/components/schemas/ProjectRosBatchUpsertRequest"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Batch upsert result or single upsert of existing record",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/ProjectRosResponse"
                    },
                    {
                      "$ref": "#/components/schemas/ProjectRosBatchUpsertResponse"
                    }
                  ]
                }
              }
            }
          },
          "201": {
            "description": "Single ROS record created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectRosResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/projects/{projectId}/ros/{rosId}": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "Project ID"
        },
        {
          "name": "rosId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string"
          },
          "description": "Slugified rosNumber number (e.g. `2024-123456`)"
        }
      ],
      "get": {
        "tags": [
          "ROS Records"
        ],
        "summary": "Get a single ROS record",
        "operationId": "getProjectRos",
        "responses": {
          "200": {
            "description": "ROS record",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectRosResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "put": {
        "tags": [
          "ROS Records"
        ],
        "summary": "Update (upsert) a ROS record",
        "description": "Updates the record identified by `rosId`. Acts as upsert \u2014 creates the record if it does not exist. Returns `200` for update, `201` for create.",
        "operationId": "updateProjectRos",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectRosMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ROS record updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectRosResponse"
                }
              }
            }
          },
          "201": {
            "description": "ROS record created via upsert",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectRosResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "patch": {
        "tags": [
          "ROS Records"
        ],
        "summary": "Patch (upsert) a ROS record",
        "description": "Identical behaviour to `PUT`. Updates the record identified by `rosId`, or creates it if absent.",
        "operationId": "patchProjectRos",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectRosMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ROS record updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectRosResponse"
                }
              }
            }
          },
          "201": {
            "description": "ROS record created via upsert",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectRosResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "delete": {
        "tags": [
          "ROS Records"
        ],
        "summary": "Delete a ROS record",
        "operationId": "deleteProjectRos",
        "responses": {
          "200": {
            "description": "Record deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "deleted"
                  ]
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/projects/{projectId}/plats": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "description": "Project identifier.",
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": [
          "Plat Records"
        ],
        "summary": "List project plat records",
        "description": "Returns all plat records for the project sorted by updatedAt descending.",
        "operationId": "listProjectPlats",
        "responses": {
          "200": {
            "description": "Plat record list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPlatListResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "post": {
        "tags": [
          "Plat Records"
        ],
        "summary": "Create or batch-upsert plat record(s)",
        "description": "Accepts either a single record body (`{ subdivisionName, ... }`) or a batch body (`{ plats: [...] }`).",
        "operationId": "upsertProjectPlats",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  {
                    "$ref": "#/components/schemas/ProjectPlatMutationRequest"
                  },
                  {
                    "$ref": "#/components/schemas/ProjectPlatBatchUpsertRequest"
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Batch upsert result or single upsert of existing record",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/ProjectPlatResponse"
                    },
                    {
                      "$ref": "#/components/schemas/ProjectPlatBatchUpsertResponse"
                    }
                  ]
                }
              }
            }
          },
          "201": {
            "description": "Single plat record created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPlatResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      }
    },
    "/api/projects/{projectId}/plats/{platId}": {
      "parameters": [
        {
          "name": "projectId",
          "in": "path",
          "required": true,
          "description": "Project ID",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "platId",
          "in": "path",
          "required": true,
          "description": "Plat identifier.",
          "schema": {
            "type": "string"
          }
        }
      ],
      "get": {
        "tags": [
          "Plat Records"
        ],
        "summary": "Get a single plat record",
        "operationId": "getProjectPlat",
        "responses": {
          "200": {
            "description": "Plat record",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPlatResponse"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      },
      "put": {
        "tags": [
          "Plat Records"
        ],
        "summary": "Update (upsert) a plat record",
        "description": "Updates the record identified by `platId`. Acts as upsert \u2014 creates the record if it does not exist.",
        "operationId": "replaceProjectPlat",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectPlatMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Plat record updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPlatResponse"
                }
              }
            }
          },
          "201": {
            "description": "Plat record created via upsert",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPlatResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "patch": {
        "tags": [
          "Plat Records"
        ],
        "summary": "Patch (upsert) a plat record",
        "description": "Identical behaviour to `PUT`. Updates the record identified by `platId`, or creates it if absent.",
        "operationId": "updateProjectPlat",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProjectPlatMutationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Plat record updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPlatResponse"
                }
              }
            }
          },
          "201": {
            "description": "Plat record created via upsert",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectPlatResponse"
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/Error400"
          }
        }
      },
      "delete": {
        "tags": [
          "Plat Records"
        ],
        "summary": "Delete a plat record",
        "operationId": "deleteProjectPlat",
        "responses": {
          "200": {
            "description": "Record deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": [
                    "deleted"
                  ],
                  "properties": {
                    "deleted": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Plat not found"
          }
        }
      }
    },
    "/api/idaho-harvest/records-of-survey": {
      "get": {
        "summary": "List harvested records of survey from object storage",
        "tags": [
          "Idaho Harvest"
        ],
        "responses": {
          "200": {
            "description": "Records of survey listing",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "records": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/HarvestArchiveDocument"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/idaho-harvest/records-of-survey/{recordId}/pdf": {
      "get": {
        "summary": "Generate a combined PDF for a harvested record of survey",
        "tags": [
          "Idaho Harvest"
        ],
        "parameters": [
          {
            "name": "recordId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Combined ROS PDF",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "Record not found"
          }
        }
      }
    },
    "/api/idaho-harvest/subdivision-plats": {
      "get": {
        "summary": "List harvested subdivision plats from object storage",
        "tags": [
          "Idaho Harvest"
        ],
        "responses": {
          "200": {
            "description": "Subdivision plat listing",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "plats": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/HarvestArchiveDocument"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/idaho-harvest/subdivision-plats/{platId}/pdf": {
      "get": {
        "summary": "Generate a combined PDF for a harvested subdivision plat",
        "tags": [
          "Idaho Harvest"
        ],
        "parameters": [
          {
            "name": "platId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Combined subdivision plat PDF",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/responses/Error404"
          }
        }
      }
    },
    "/api/recordquarry/subdivision-plats/page-list": {
      "get": {
        "tags": [
          "RecordQuarry"
        ],
        "summary": "Proxy Ada County subdivision plat page list text",
        "responses": {
          "200": {
            "description": "Raw text document body.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "502": {
            "description": "Upstream list fetch failed.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/recordquarry/records-of-survey/page-list": {
      "get": {
        "tags": [
          "RecordQuarry"
        ],
        "summary": "Proxy Ada County record-of-survey page list text",
        "responses": {
          "200": {
            "description": "Raw text document body.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "502": {
            "description": "Upstream list fetch failed.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "parameters": {
      "addressRequired": {
        "name": "address",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string",
          "minLength": 1
        },
        "description": "Street address"
      },
      "lonRequired": {
        "name": "lon",
        "in": "query",
        "required": true,
        "schema": {
          "type": "number"
        },
        "description": "Longitude (WGS 84)"
      },
      "latRequired": {
        "name": "lat",
        "in": "query",
        "required": true,
        "schema": {
          "type": "number"
        },
        "description": "Latitude (WGS 84)"
      },
      "outSR4326": {
        "name": "outSR",
        "in": "query",
        "required": false,
        "schema": {
          "type": "number",
          "default": 4326
        },
        "description": "Output spatial reference WKID"
      },
      "outSR2243": {
        "name": "outSR",
        "in": "query",
        "required": false,
        "schema": {
          "type": "number",
          "default": 2243
        },
        "description": "Output spatial reference WKID (default Idaho State Plane West, US Feet)"
      },
      "searchMeters40": {
        "name": "searchMeters",
        "in": "query",
        "required": false,
        "schema": {
          "type": "number",
          "default": 40
        },
        "description": "Search radius in meters"
      },
      "sourcesPower": {
        "name": "sources",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "default": "power"
        },
        "description": "Comma-separated source types to query"
      },
      "projectIdOptional": {
        "name": "projectId",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "Project ID (auto-generated if omitted)"
      },
      "projectIdRequired": {
        "name": "projectId",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string",
          "minLength": 1
        },
        "description": "Project ID"
      },
      "projectNameOptional": {
        "name": "projectName",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "Project display name"
      },
      "clientOptional": {
        "name": "client",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "Client name"
      },
      "addressOptional": {
        "name": "address",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "Project address"
      },
      "resourcesJsonOptional": {
        "name": "resources",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "JSON-encoded array of resource objects"
      },
      "folderKeyRequired": {
        "name": "folderKey",
        "in": "query",
        "required": true,
        "schema": {
          "$ref": "#/components/schemas/FolderKey"
        },
        "description": "Folder key"
      },
      "fileNameRequired": {
        "name": "fileName",
        "in": "query",
        "required": true,
        "schema": {
          "type": "string",
          "minLength": 1
        },
        "description": "Stored filename (from upload response)"
      },
      "idOptional": {
        "name": "id",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string"
        },
        "description": "Optional entity ID filter"
      },
      "roomDefault": {
        "name": "room",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "default": "default"
        },
        "description": "Room filter"
      },
      "fileDefaultFld": {
        "name": "file",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "default": "config/MLS.fld"
        },
        "description": "Relative path to the FLD config file"
      },
      "poolDefault": {
        "name": "pool",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "default": "default"
        },
        "description": "Worker pool to query"
      },
      "maxPages1": {
        "name": "maxPages",
        "in": "query",
        "required": false,
        "schema": {
          "type": "integer",
          "default": 1,
          "minimum": 1
        },
        "description": "Max pages to process"
      },
      "dpi220": {
        "name": "dpi",
        "in": "query",
        "required": false,
        "schema": {
          "type": "integer",
          "default": 220,
          "minimum": 50
        },
        "description": "OCR resolution"
      },
      "async01": {
        "name": "async",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "enum": [
            "0",
            "1"
          ],
          "default": "0"
        },
        "description": "Run asynchronously (\"1\") or synchronously (\"0\")"
      },
      "allowSlow01": {
        "name": "allowSlow",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "enum": [
            "0",
            "1"
          ],
          "default": "0"
        },
        "description": "Allow higher limits for maxPages and dpi"
      },
      "debug01": {
        "name": "debug",
        "in": "query",
        "required": false,
        "schema": {
          "type": "string",
          "enum": [
            "0",
            "1"
          ],
          "default": "0"
        },
        "description": "Include debug output"
      },
      "TraverseIdPath": {
        "name": "traverseId",
        "in": "path",
        "required": true,
        "schema": {
          "type": "string"
        }
      }
    },
    "responses": {
      "Error400": {
        "description": "Bad request / validation error",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "Error403": {
        "description": "Forbidden (e.g., path traversal attempt)",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "Error404": {
        "description": "Resource not found",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "Error502": {
        "description": "Upstream server error (proxied requests)",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      },
      "Error507": {
        "description": "Insufficient storage capacity in Redis-backed upload store.",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/ErrorResponse"
            }
          }
        }
      }
    },
    "schemas": {
      "ErrorResponse": {
        "type": "object",
        "required": [
          "error"
        ],
        "properties": {
          "error": {
            "type": "string"
          }
        },
        "additionalProperties": true
      },
      "HealthResponse": {
        "type": "object",
        "required": [
          "ok"
        ],
        "properties": {
          "ok": {
            "type": "boolean",
            "const": true
          }
        },
        "additionalProperties": false
      },
      "AppCatalogResponse": {
        "type": "object",
        "required": [
          "apps"
        ],
        "properties": {
          "apps": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AppEntry"
            }
          }
        },
        "additionalProperties": false
      },
      "AppEntry": {
        "type": "object",
        "required": [
          "name",
          "entryHtml",
          "iconPath"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique app identifier"
          },
          "name": {
            "type": "string",
            "description": "Display name"
          },
          "description": {
            "type": "string",
            "description": "Human-readable description"
          },
          "entryHtml": {
            "type": "string",
            "description": "HTML entry point filename"
          },
          "iconPath": {
            "type": "string",
            "description": "Path to the app icon"
          },
          "section": {
            "type": [
              "string",
              "null"
            ],
            "description": "Category grouping"
          },
          "experimental": {
            "type": "boolean",
            "description": "True if experimental"
          },
          "iconHeight": {
            "type": "number"
          }
        },
        "additionalProperties": true
      },
      "LookupResult": {
        "type": "object",
        "description": "Implementation-defined payload from SurveyCadClient.lookupByAddress().",
        "additionalProperties": true
      },
      "GeocodeResult": {
        "type": "object",
        "description": "Geocode result with coordinates and metadata (implementation-defined).",
        "additionalProperties": true
      },
      "ArcGisFeature": {
        "type": "object",
        "description": "Generic ArcGIS feature (attributes + geometry).",
        "properties": {
          "attributes": {
            "type": "object",
            "additionalProperties": true
          },
          "geometry": {
            "type": [
              "object",
              "null"
            ],
            "additionalProperties": true
          }
        },
        "additionalProperties": true
      },
      "ParcelResponse": {
        "type": "object",
        "required": [
          "parcel"
        ],
        "properties": {
          "parcel": {
            "$ref": "#/components/schemas/ArcGisFeature"
          }
        },
        "additionalProperties": false
      },
      "SectionResponse": {
        "type": "object",
        "required": [
          "section"
        ],
        "properties": {
          "section": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ArcGisFeature"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "additionalProperties": false
      },
      "AliquotsResponse": {
        "type": "object",
        "required": [
          "section",
          "aliquots"
        ],
        "properties": {
          "section": {
            "$ref": "#/components/schemas/ArcGisFeature"
          },
          "aliquots": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ArcGisFeature"
            }
          }
        },
        "additionalProperties": false
      },
      "SubdivisionResponse": {
        "type": "object",
        "required": [
          "subdivision"
        ],
        "properties": {
          "subdivision": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ArcGisFeature"
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "additionalProperties": false
      },
      "UtilitiesResponse": {
        "type": "object",
        "required": [
          "utilities",
          "sources"
        ],
        "properties": {
          "utilities": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ArcGisFeature"
            }
          },
          "sources": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "additionalProperties": false
      },
      "FolderKey": {
        "type": "string",
        "enum": [
          "drawings",
          "ros",
          "cpfs",
          "point-files",
          "deeds",
          "plats",
          "invoices",
          "other"
        ]
      },
      "ProjectFileTemplateResponse": {
        "type": "object",
        "required": [
          "projectFile"
        ],
        "properties": {
          "projectFile": {
            "$ref": "#/components/schemas/ProjectFile"
          }
        },
        "additionalProperties": false
      },
      "ProjectFile": {
        "type": "object",
        "required": [
          "schemaVersion",
          "generatedAt",
          "project",
          "archive",
          "folders"
        ],
        "properties": {
          "schemaVersion": {
            "type": "string",
            "description": "Schema version, e.g. 1.0.0"
          },
          "generatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "project": {
            "$ref": "#/components/schemas/Project"
          },
          "archive": {
            "$ref": "#/components/schemas/Archive"
          },
          "folders": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Folder"
            }
          }
        },
        "additionalProperties": true
      },
      "Project": {
        "type": "object",
        "required": [
          "id",
          "name",
          "client",
          "address"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "client": {
            "type": "string"
          },
          "address": {
            "type": "string"
          }
        },
        "additionalProperties": true
      },
      "Archive": {
        "type": "object",
        "required": [
          "type",
          "rootFolderName"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "e.g. zip"
          },
          "rootFolderName": {
            "type": "string"
          }
        },
        "additionalProperties": true
      },
      "Folder": {
        "type": "object",
        "required": [
          "key",
          "label",
          "description",
          "index"
        ],
        "properties": {
          "key": {
            "$ref": "#/components/schemas/FolderKey"
          },
          "label": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "index": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Resource"
            }
          }
        },
        "additionalProperties": true
      },
      "Resource": {
        "type": "object",
        "required": [
          "id",
          "folder",
          "title",
          "exportFormat",
          "reference"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "folder": {
            "$ref": "#/components/schemas/FolderKey"
          },
          "title": {
            "type": "string"
          },
          "exportFormat": {
            "type": "string",
            "description": "File extension (dxf, pdf, csv, bin, etc.)"
          },
          "reference": {
            "$ref": "#/components/schemas/Reference"
          }
        },
        "additionalProperties": true
      },
      "Reference": {
        "type": "object",
        "required": [
          "type",
          "value"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "external | server-upload | custom"
          },
          "value": {
            "type": "string",
            "description": "URL or reference path"
          },
          "resolverHint": {
            "type": [
              "string",
              "null"
            ]
          },
          "metadata": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "additionalProperties": true
      },
      "CompileProjectFileRequest": {
        "type": "object",
        "required": [
          "project"
        ],
        "properties": {
          "projectFile": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/ProjectFile"
              },
              {
                "type": "null"
              }
            ]
          },
          "project": {
            "type": "object",
            "required": [
              "projectId",
              "projectName",
              "client",
              "address"
            ],
            "properties": {
              "projectId": {
                "type": "string"
              },
              "projectName": {
                "type": "string"
              },
              "client": {
                "type": "string"
              },
              "address": {
                "type": "string"
              }
            },
            "additionalProperties": true
          }
        },
        "additionalProperties": false
      },
      "CompileProjectFileResponse": {
        "type": "object",
        "required": [
          "projectFile",
          "archivePlan"
        ],
        "properties": {
          "projectFile": {
            "$ref": "#/components/schemas/ProjectFile"
          },
          "archivePlan": {
            "$ref": "#/components/schemas/ArchivePlan"
          }
        },
        "additionalProperties": false
      },
      "ArchivePlan": {
        "type": "object",
        "required": [
          "archiveName",
          "rootFolderName",
          "entries",
          "unresolved"
        ],
        "properties": {
          "archiveName": {
            "type": "string"
          },
          "rootFolderName": {
            "type": "string"
          },
          "entries": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ArchiveEntry"
            }
          },
          "unresolved": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": true
            }
          }
        },
        "additionalProperties": true
      },
      "ArchiveEntry": {
        "type": "object",
        "required": [
          "path",
          "source"
        ],
        "properties": {
          "path": {
            "type": "string"
          },
          "source": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "additionalProperties": false
      },
      "UploadProjectFileResponse": {
        "type": "object",
        "required": [
          "resource"
        ],
        "properties": {
          "resource": {
            "$ref": "#/components/schemas/Resource"
          }
        },
        "additionalProperties": false
      },
      "ProjectFilesListResponse": {
        "type": "object",
        "required": [
          "files",
          "filesByFolder"
        ],
        "properties": {
          "files": {
            "type": "array",
            "items": {
              "type": "object",
              "required": [
                "folderKey",
                "fileName",
                "title",
                "sizeBytes",
                "uploadedAt",
                "updatedAt"
              ],
              "properties": {
                "folderKey": {
                  "$ref": "#/components/schemas/FolderKey"
                },
                "fileName": {
                  "type": "string"
                },
                "title": {
                  "type": "string"
                },
                "sizeBytes": {
                  "type": "integer"
                },
                "uploadedAt": {
                  "type": "string",
                  "format": "date-time"
                },
                "updatedAt": {
                  "type": "string",
                  "format": "date-time"
                },
                "rosNumber": {
                  "type": [
                    "string",
                    "null"
                  ],
                  "description": "Optional ROS map number assigned to the uploaded file."
                },
                "pointNumber": {
                  "type": "string",
                  "nullable": true
                }
              },
              "additionalProperties": false
            }
          },
          "filesByFolder": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [
                  "folderKey",
                  "fileName",
                  "title",
                  "sizeBytes",
                  "uploadedAt",
                  "updatedAt"
                ],
                "properties": {
                  "folderKey": {
                    "$ref": "#/components/schemas/FolderKey"
                  },
                  "fileName": {
                    "type": "string"
                  },
                  "title": {
                    "type": "string"
                  },
                  "sizeBytes": {
                    "type": "integer"
                  },
                  "uploadedAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "updatedAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "rosNumber": {
                    "type": [
                      "string",
                      "null"
                    ],
                    "description": "Optional ROS map number assigned to the uploaded file."
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "additionalProperties": false
      },
      "CrewMember": {
        "type": "object",
        "required": [
          "id",
          "firstName",
          "lastName",
          "jobTitle",
          "phone",
          "email",
          "certifications",
          "notes",
          "roles",
          "photo",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "jobTitle": {
            "type": "string"
          },
          "phone": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "certifications": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          },
          "roles": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "photo": {
            "type": [
              "object",
              "array",
              "string",
              "number",
              "boolean",
              "null"
            ]
          },
          "lineSmithActiveDrawingByProject": {
            "type": "object",
            "description": "Optional map of projectId to the last active drawingId for LineSmith cross-device restore.",
            "additionalProperties": {
              "type": "string"
            }
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": true
      },
      "CrewMemberUpsert": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "description": "Optional UUID; auto-generated if omitted"
              },
              "firstName": {
                "type": "string",
                "default": ""
              },
              "lastName": {
                "type": "string",
                "default": ""
              },
              "jobTitle": {
                "type": "string",
                "default": ""
              },
              "phone": {
                "type": "string",
                "default": ""
              },
              "email": {
                "type": "string",
                "default": ""
              },
              "certifications": {
                "type": "string",
                "default": ""
              },
              "notes": {
                "type": "string",
                "default": ""
              },
              "roles": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "default": []
              },
              "photo": {
                "type": [
                  "object",
                  "array",
                  "string",
                  "number",
                  "boolean",
                  "null"
                ],
                "default": null
              },
              "lineSmithActiveDrawingByProject": {
                "type": "object",
                "description": "Optional map of projectId to the last active drawingId for LineSmith cross-device restore.",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "createdAt": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp; defaults to now if omitted"
              }
            },
            "additionalProperties": true
          },
          {
            "oneOf": [
              {
                "required": [
                  "firstName"
                ]
              },
              {
                "required": [
                  "lastName"
                ]
              },
              {
                "required": [
                  "id",
                  "lineSmithActiveDrawingByProject"
                ]
              }
            ]
          }
        ]
      },
      "CrewListResponse": {
        "type": "object",
        "required": [
          "crew"
        ],
        "properties": {
          "crew": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CrewMember"
            }
          }
        },
        "additionalProperties": false
      },
      "CrewMemberResponse": {
        "type": "object",
        "required": [
          "member"
        ],
        "properties": {
          "member": {
            "$ref": "#/components/schemas/CrewMember"
          }
        },
        "additionalProperties": false
      },
      "CrewPresenceResponse": {
        "type": "object",
        "required": [
          "online"
        ],
        "properties": {
          "online": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "additionalProperties": false
      },
      "Equipment": {
        "type": "object",
        "required": [
          "id",
          "make",
          "model",
          "equipmentType",
          "serialNumber",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "make": {
            "type": "string"
          },
          "model": {
            "type": "string"
          },
          "equipmentType": {
            "type": "string"
          },
          "serialNumber": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": true
      },
      "EquipmentUpsert": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "description": "Optional UUID; auto-generated if omitted"
              },
              "make": {
                "type": "string",
                "default": ""
              },
              "model": {
                "type": "string",
                "default": ""
              },
              "equipmentType": {
                "type": "string",
                "default": ""
              },
              "serialNumber": {
                "type": "string",
                "default": ""
              },
              "createdAt": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp; defaults to now if omitted"
              }
            },
            "additionalProperties": true
          },
          {
            "oneOf": [
              {
                "required": [
                  "make"
                ]
              },
              {
                "required": [
                  "model"
                ]
              }
            ]
          }
        ]
      },
      "EquipmentListResponse": {
        "type": "object",
        "required": [
          "equipment"
        ],
        "properties": {
          "equipment": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Equipment"
            }
          }
        },
        "additionalProperties": false
      },
      "EquipmentResponse": {
        "type": "object",
        "required": [
          "equipment"
        ],
        "properties": {
          "equipment": {
            "$ref": "#/components/schemas/Equipment"
          }
        },
        "additionalProperties": false
      },
      "EquipmentLog": {
        "type": "object",
        "required": [
          "id",
          "rodman",
          "equipmentHeight",
          "referencePoint",
          "setupTime",
          "teardownTime",
          "jobFileName",
          "equipmentType",
          "notes",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "rodman": {
            "type": "string"
          },
          "equipmentHeight": {
            "type": "string"
          },
          "referencePoint": {
            "type": "string"
          },
          "setupTime": {
            "type": "string"
          },
          "teardownTime": {
            "type": "string"
          },
          "jobFileName": {
            "type": "string"
          },
          "equipmentType": {
            "type": "string"
          },
          "notes": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "pointFileId": {
            "type": "string",
            "description": "Linked project point-file ID created from an attached Equipment Log point file."
          },
          "pointFileName": {
            "type": "string",
            "description": "Original point-file name attached to this equipment log entry."
          },
          "pointFileProjectId": {
            "type": "string",
            "description": "Project ID used when storing the attached point file into project point-files."
          }
        },
        "additionalProperties": true
      },
      "EquipmentLogUpsert": {
        "allOf": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "description": "Optional UUID; auto-generated if omitted"
              },
              "rodman": {
                "type": "string",
                "default": ""
              },
              "equipmentHeight": {
                "type": "string",
                "default": ""
              },
              "referencePoint": {
                "type": "string",
                "default": ""
              },
              "setupTime": {
                "type": "string",
                "default": ""
              },
              "teardownTime": {
                "type": "string",
                "default": ""
              },
              "jobFileName": {
                "type": "string",
                "default": ""
              },
              "equipmentType": {
                "type": "string",
                "default": ""
              },
              "notes": {
                "type": "string",
                "default": ""
              },
              "createdAt": {
                "type": "string",
                "format": "date-time",
                "description": "Creation timestamp; defaults to now if omitted"
              }
            },
            "additionalProperties": true
          },
          {
            "oneOf": [
              {
                "required": [
                  "rodman"
                ]
              },
              {
                "required": [
                  "jobFileName"
                ]
              }
            ]
          }
        ],
        "properties": {
          "pointFileId": {
            "type": "string",
            "description": "Linked project point-file ID created from an attached Equipment Log point file."
          },
          "pointFileName": {
            "type": "string",
            "description": "Original point-file name attached to this equipment log entry."
          },
          "pointFileProjectId": {
            "type": "string",
            "description": "Project ID used when storing the attached point file into project point-files."
          }
        }
      },
      "EquipmentLogListResponse": {
        "type": "object",
        "required": [
          "logs"
        ],
        "properties": {
          "logs": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/EquipmentLog"
            }
          }
        },
        "additionalProperties": false
      },
      "EquipmentLogResponse": {
        "type": "object",
        "required": [
          "log"
        ],
        "properties": {
          "log": {
            "$ref": "#/components/schemas/EquipmentLog"
          }
        },
        "additionalProperties": false
      },
      "SyncState": {
        "type": "object",
        "required": [
          "version",
          "snapshot",
          "checksum",
          "updatedAt"
        ],
        "properties": {
          "version": {
            "type": "integer",
            "description": "Monotonically increasing version counter"
          },
          "snapshot": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "Key-value map (values are JSON-encoded strings)"
          },
          "checksum": {
            "type": "string",
            "description": "FNV-1a 32-bit checksum, format fnv1a-<hex>"
          },
          "updatedAt": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        },
        "additionalProperties": false
      },
      "SyncStatePushRequest": {
        "type": "object",
        "required": [
          "version",
          "snapshot"
        ],
        "properties": {
          "version": {
            "type": "integer"
          },
          "snapshot": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "additionalProperties": false
      },
      "SyncStatePushResponse": {
        "type": "object",
        "required": [
          "status",
          "state"
        ],
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "server-updated",
              "client-stale",
              "checksum-conflict",
              "in-sync"
            ]
          },
          "state": {
            "$ref": "#/components/schemas/SyncState"
          }
        },
        "additionalProperties": false
      },
      "PointForgeExport": {
        "type": "object",
        "required": [
          "id",
          "roomId",
          "modifiedCsv",
          "createdAt"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "pf-export-{timestamp}-{uuid8}"
          },
          "roomId": {
            "type": "string"
          },
          "originalCsv": {
            "type": "string"
          },
          "modifiedCsv": {
            "type": "string"
          },
          "georeference": {
            "anyOf": [
              {
                "type": "object",
                "additionalProperties": true
              },
              {
                "type": "null"
              }
            ]
          },
          "metadata": {
            "type": "object",
            "additionalProperties": true
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "additionalProperties": true
      },
      "PointForgeExportListResponse": {
        "type": "object",
        "required": [
          "exports"
        ],
        "properties": {
          "exports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PointForgeExport"
            }
          }
        },
        "additionalProperties": false
      },
      "PointForgeExportResponse": {
        "type": "object",
        "required": [
          "export"
        ],
        "properties": {
          "export": {
            "$ref": "#/components/schemas/PointForgeExport"
          }
        },
        "additionalProperties": false
      },
      "PointForgeExportCreateRequest": {
        "type": "object",
        "required": [
          "modifiedCsv"
        ],
        "properties": {
          "modifiedCsv": {
            "type": "string"
          },
          "originalCsv": {
            "type": "string"
          },
          "georeference": {
            "anyOf": [
              {
                "type": "object",
                "additionalProperties": true
              },
              {
                "type": "null"
              }
            ]
          },
          "metadata": {
            "type": "object",
            "additionalProperties": true
          },
          "roomId": {
            "type": "string",
            "default": "default"
          }
        },
        "additionalProperties": false
      },
      "FldConfig": {
        "type": "object",
        "required": [
          "columns",
          "rules",
          "rulesByCode"
        ],
        "properties": {
          "versionTag": {
            "type": [
              "string",
              "null"
            ]
          },
          "columns": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FldColumn"
            }
          },
          "rules": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FldRule"
            }
          },
          "rulesByCode": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/components/schemas/FldRule"
            }
          }
        },
        "additionalProperties": true
      },
      "FldColumn": {
        "type": "object",
        "required": [
          "index",
          "name",
          "key"
        ],
        "properties": {
          "index": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "key": {
            "type": "string"
          }
        },
        "additionalProperties": false
      },
      "FldRule": {
        "type": "object",
        "required": [
          "rowNumber",
          "code",
          "description",
          "fullName",
          "layer",
          "entityType",
          "lineType",
          "symbol",
          "symbolSize",
          "symbolMapFile",
          "processingOn",
          "codeSequence",
          "companionCodes",
          "raw"
        ],
        "properties": {
          "rowNumber": {
            "type": "integer"
          },
          "code": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "fullName": {
            "type": "string"
          },
          "layer": {
            "type": "string"
          },
          "entityType": {
            "type": "string"
          },
          "lineType": {
            "type": "string"
          },
          "symbol": {
            "type": "string"
          },
          "symbolSize": {
            "type": "string"
          },
          "symbolMapFile": {
            "type": "string"
          },
          "processingOn": {
            "type": "boolean"
          },
          "codeSequence": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "companionCodes": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "raw": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "additionalProperties": true
      },
      "WorkerSubmitRequest": {
        "type": "object",
        "required": [
          "kind"
        ],
        "properties": {
          "poolId": {
            "type": "string",
            "default": "default"
          },
          "kind": {
            "type": "string",
            "description": "Task type identifier"
          },
          "payload": {
            "type": [
              "object",
              "array",
              "string",
              "number",
              "boolean",
              "null"
            ],
            "default": null
          }
        },
        "additionalProperties": false
      },
      "WorkerSubmitSuccessResponse": {
        "type": "object",
        "required": [
          "ok",
          "taskId",
          "result"
        ],
        "properties": {
          "ok": {
            "type": "boolean",
            "const": true
          },
          "taskId": {
            "type": "string"
          },
          "result": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "additionalProperties": true
      },
      "WorkerSubmitFailureResponse": {
        "type": "object",
        "required": [
          "ok",
          "taskId",
          "error"
        ],
        "properties": {
          "ok": {
            "type": "boolean",
            "const": false
          },
          "taskId": {
            "type": "string"
          },
          "error": {
            "type": "string"
          },
          "details": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "additionalProperties": true
      },
      "NoWorkersResponse": {
        "type": "object",
        "required": [
          "error",
          "workers"
        ],
        "properties": {
          "error": {
            "type": "string",
            "const": "No online workers in pool."
          },
          "workers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WorkerInfo"
            }
          }
        },
        "additionalProperties": true
      },
      "WorkerWorkersResponse": {
        "type": "object",
        "required": [
          "workers"
        ],
        "properties": {
          "workers": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/WorkerInfo"
            }
          }
        },
        "additionalProperties": false
      },
      "WorkerInfo": {
        "type": "object",
        "required": [
          "workerId",
          "poolId",
          "concurrency",
          "inFlight",
          "online",
          "lastSeen"
        ],
        "properties": {
          "workerId": {
            "type": "string"
          },
          "poolId": {
            "type": "string"
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "concurrency": {
            "type": "integer"
          },
          "inFlight": {
            "type": "integer"
          },
          "online": {
            "type": "boolean"
          },
          "lastSeen": {
            "type": "integer",
            "description": "Unix timestamp (ms)"
          },
          "capabilities": {
            "anyOf": [
              {
                "type": "object",
                "additionalProperties": true
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "additionalProperties": true
      },
      "ExtractRequestEcho": {
        "type": "object",
        "properties": {
          "allowSlow": {
            "type": "boolean"
          },
          "requestedMaxPages": {
            "type": "integer"
          },
          "requestedDpi": {
            "type": "integer"
          },
          "maxPages": {
            "type": "integer"
          },
          "dpi": {
            "type": "integer"
          }
        },
        "additionalProperties": true
      },
      "ExtractSyncResponse": {
        "type": "object",
        "required": [
          "basis",
          "request"
        ],
        "properties": {
          "basis": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": true
            }
          },
          "request": {
            "$ref": "#/components/schemas/ExtractRequestEcho"
          }
        },
        "additionalProperties": true
      },
      "ExtractAsyncResponse": {
        "type": "object",
        "required": [
          "jobId",
          "status",
          "statusUrl",
          "pollAfterMs",
          "request"
        ],
        "properties": {
          "jobId": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "queued"
            ]
          },
          "statusUrl": {
            "type": "string"
          },
          "pollAfterMs": {
            "type": "integer"
          },
          "request": {
            "$ref": "#/components/schemas/ExtractRequestEcho"
          }
        },
        "additionalProperties": true
      },
      "ExtractJobRunningResponse": {
        "type": "object",
        "required": [
          "jobId",
          "status",
          "request",
          "pollAfterMs"
        ],
        "properties": {
          "jobId": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "running"
            ]
          },
          "request": {
            "$ref": "#/components/schemas/ExtractRequestEcho"
          },
          "pollAfterMs": {
            "type": "integer"
          }
        },
        "additionalProperties": true
      },
      "ExtractJobCompletedResponse": {
        "type": "object",
        "required": [
          "jobId",
          "status",
          "request",
          "basis"
        ],
        "properties": {
          "jobId": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "completed"
            ]
          },
          "request": {
            "$ref": "#/components/schemas/ExtractRequestEcho"
          },
          "basis": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": true
            }
          }
        },
        "additionalProperties": true
      },
      "ExtractJobFailedResponse": {
        "type": "object",
        "required": [
          "jobId",
          "status",
          "request",
          "error"
        ],
        "properties": {
          "jobId": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "failed"
            ]
          },
          "request": {
            "$ref": "#/components/schemas/ExtractRequestEcho"
          },
          "error": {
            "type": "string"
          }
        },
        "additionalProperties": true
      },
      "LineSmithDrawingSummary": {
        "type": "object",
        "properties": {
          "drawingId": {
            "type": "string"
          },
          "drawingName": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "latestVersionId": {
            "type": [
              "string",
              "null"
            ]
          },
          "versionCount": {
            "type": "integer"
          },
          "latestMapGeoreference": {
            "type": [
              "object",
              "null"
            ],
            "additionalProperties": true
          }
        },
        "required": [
          "drawingId",
          "drawingName",
          "createdAt",
          "updatedAt",
          "latestVersionId",
          "versionCount",
          "latestMapGeoreference"
        ],
        "additionalProperties": false
      },
      "LineSmithDrawingVersion": {
        "type": "object",
        "properties": {
          "versionId": {
            "type": "string"
          },
          "savedAt": {
            "type": "string",
            "format": "date-time"
          },
          "label": {
            "type": "string"
          },
          "baseState": {
            "type": "object",
            "additionalProperties": true
          },
          "diffFromPrevious": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "required": [
          "versionId",
          "savedAt",
          "label"
        ],
        "additionalProperties": true
      },
      "LineSmithDrawingRecord": {
        "type": "object",
        "properties": {
          "schemaVersion": {
            "type": "string"
          },
          "projectId": {
            "type": "string"
          },
          "drawingId": {
            "type": "string"
          },
          "drawingName": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "latestMapGeoreference": {
            "type": [
              "object",
              "null"
            ],
            "additionalProperties": true
          },
          "versions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LineSmithDrawingVersion"
            }
          },
          "currentState": {
            "type": "object",
            "additionalProperties": true
          },
          "linkedPointFileProjectId": {
            "type": "string",
            "nullable": true,
            "description": "Project ID for the linked point file that receives synchronized point updates."
          },
          "linkedPointFileId": {
            "type": "string",
            "nullable": true,
            "description": "Point file ID linked to this drawing for synchronized point updates."
          },
          "linkedPointFileName": {
            "type": "string",
            "nullable": true,
            "description": "Display name of the linked point file."
          }
        },
        "required": [
          "projectId",
          "drawingId",
          "drawingName",
          "createdAt",
          "updatedAt",
          "versions"
        ],
        "additionalProperties": true
      },
      "LineSmithDrawingMutationRequest": {
        "type": "object",
        "properties": {
          "drawingId": {
            "type": "string"
          },
          "drawingName": {
            "type": "string"
          },
          "drawingState": {
            "type": "object",
            "additionalProperties": true
          },
          "pointFileLink": {
            "$ref": "#/components/schemas/LineSmithDrawingPointFileLink"
          }
        },
        "additionalProperties": false,
        "description": "For PUT/PATCH, drawingState is optional and defaults to the drawing's current state, allowing point-file relinking without resending geometry. For POST create, drawingState is required."
      },
      "LineSmithDrawingListResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "drawings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/LineSmithDrawingSummary"
            }
          }
        },
        "required": [
          "projectId",
          "drawings"
        ],
        "additionalProperties": false
      },
      "LineSmithDrawingResponse": {
        "type": "object",
        "properties": {
          "drawing": {
            "$ref": "#/components/schemas/LineSmithDrawingRecord"
          }
        },
        "required": [
          "drawing"
        ],
        "additionalProperties": false
      },
      "LineSmithDrawingDeleteResponse": {
        "type": "object",
        "properties": {
          "deleted": {
            "type": "boolean"
          }
        },
        "required": [
          "deleted"
        ],
        "additionalProperties": false
      },
      "ProjectPointFileState": {
        "type": "object",
        "properties": {
          "text": {
            "type": "string"
          },
          "exportFormat": {
            "type": "string",
            "default": "csv"
          }
        },
        "required": [
          "text"
        ]
      },
      "ProjectPointFileVersion": {
        "type": "object",
        "properties": {
          "versionId": {
            "type": "string"
          },
          "savedAt": {
            "type": "string",
            "format": "date-time"
          },
          "label": {
            "type": "string"
          },
          "baseState": {
            "$ref": "#/components/schemas/ProjectPointFileState"
          },
          "diffFromPrevious": {
            "type": "object",
            "additionalProperties": true
          },
          "actor": {
            "$ref": "#/components/schemas/ProjectPointFileChangeContext"
          }
        }
      },
      "ProjectPointFile": {
        "type": "object",
        "properties": {
          "schemaVersion": {
            "type": "string"
          },
          "projectId": {
            "type": "string"
          },
          "pointFileId": {
            "type": "string"
          },
          "pointFileName": {
            "type": "string"
          },
          "exportFormat": {
            "type": "string"
          },
          "source": {
            "type": [
              "string",
              "null"
            ]
          },
          "sourceLabel": {
            "type": [
              "string",
              "null"
            ]
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "versions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectPointFileVersion"
            }
          },
          "currentState": {
            "$ref": "#/components/schemas/ProjectPointFileState"
          },
          "selectedVersionId": {
            "type": [
              "string",
              "null"
            ]
          }
        },
        "required": [
          "projectId",
          "pointFileId",
          "pointFileName",
          "versions"
        ]
      },
      "ProjectPointFileSummary": {
        "type": "object",
        "properties": {
          "pointFileId": {
            "type": "string"
          },
          "pointFileName": {
            "type": "string"
          },
          "exportFormat": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "latestVersionId": {
            "type": [
              "string",
              "null"
            ]
          },
          "versionCount": {
            "type": "integer"
          },
          "source": {
            "type": [
              "string",
              "null"
            ]
          },
          "sourceLabel": {
            "type": [
              "string",
              "null"
            ]
          }
        },
        "required": [
          "pointFileId",
          "pointFileName"
        ]
      },
      "ProjectPointFileMutationRequest": {
        "type": "object",
        "properties": {
          "pointFileId": {
            "type": "string"
          },
          "pointFileName": {
            "type": "string"
          },
          "pointFileState": {
            "$ref": "#/components/schemas/ProjectPointFileState"
          },
          "source": {
            "type": "string"
          },
          "sourceLabel": {
            "type": "string"
          },
          "changeContext": {
            "$ref": "#/components/schemas/ProjectPointFileChangeContext"
          }
        },
        "required": [
          "pointFileState"
        ]
      },
      "ProjectPointFileListResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "pointFiles": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectPointFileSummary"
            }
          }
        },
        "required": [
          "projectId",
          "pointFiles"
        ]
      },
      "ProjectPointFileResponse": {
        "type": "object",
        "properties": {
          "pointFile": {
            "$ref": "#/components/schemas/ProjectPointFile"
          }
        },
        "required": [
          "pointFile"
        ]
      },
      "ProjectCpfSummary": {
        "type": "object",
        "description": "Lightweight CP&F summary stored in the project index (returned by list).",
        "properties": {
          "cpfId": {
            "type": "string",
            "description": "Slugified instrument number (e.g. \"2024-123456\")"
          },
          "instrument": {
            "type": "string",
            "description": "Normalized instrument number (uppercase)"
          },
          "title": {
            "type": "string",
            "description": "Display title"
          },
          "source": {
            "type": "string",
            "nullable": true,
            "description": "Originating app (e.g. \"RecordQuarry\") or null"
          },
          "aliquots": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "PLSS aliquot labels"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "starredInFieldBook": {
            "type": "boolean",
            "description": "Whether this CP&F is starred for field-book print jobs."
          }
        },
        "required": [
          "cpfId",
          "instrument",
          "title",
          "aliquots",
          "createdAt",
          "updatedAt",
          "starredInFieldBook"
        ]
      },
      "ProjectCpf": {
        "type": "object",
        "description": "Full CP&F record persisted in the sync snapshot.",
        "properties": {
          "schemaVersion": {
            "type": "string",
            "example": "1.0.0"
          },
          "projectId": {
            "type": "string"
          },
          "cpfId": {
            "type": "string",
            "description": "Slugified instrument number derived at write time"
          },
          "instrument": {
            "type": "string",
            "description": "Normalized instrument number (uppercase)"
          },
          "title": {
            "type": "string",
            "description": "Display title (defaults to \"CP&F {instrument}\")"
          },
          "source": {
            "type": "string",
            "nullable": true,
            "description": "Originating app (e.g. \"RecordQuarry\") or null"
          },
          "aliquots": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "PLSS aliquot labels"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "starredInFieldBook": {
            "type": "boolean",
            "description": "Whether this CP&F is starred for field-book print jobs."
          }
        },
        "required": [
          "schemaVersion",
          "projectId",
          "cpfId",
          "instrument",
          "title",
          "aliquots",
          "createdAt",
          "updatedAt",
          "starredInFieldBook"
        ]
      },
      "ProjectCpfMutationRequest": {
        "type": "object",
        "description": "Request body for single CP&F create/update (POST without batch, PUT, or PATCH).",
        "properties": {
          "instrument": {
            "type": "string",
            "description": "Instrument number. Normalized to uppercase; `cpfId` is derived by slugifying this value."
          },
          "title": {
            "type": "string",
            "description": "Display title. Defaults to \"CP&F {instrument}\" when omitted."
          },
          "source": {
            "type": "string",
            "nullable": true,
            "description": "Originating app label (e.g. \"RecordQuarry\")"
          },
          "aliquots": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "PLSS aliquot labels to associate with this record"
          },
          "starredInFieldBook": {
            "type": "boolean",
            "description": "Whether this CP&F is starred for field-book print jobs."
          }
        },
        "required": [
          "instrument"
        ]
      },
      "ProjectCpfBatchUpsertRequest": {
        "type": "object",
        "description": "Request body for atomic batch upsert of multiple CP&F records.",
        "properties": {
          "cpfs": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectCpfMutationRequest"
            },
            "description": "Array of CP&F entries to upsert. Entries missing `instrument` are silently skipped."
          }
        },
        "required": [
          "cpfs"
        ]
      },
      "ProjectCpfListResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "cpfs": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectCpfSummary"
            },
            "description": "CP&F summaries sorted by updatedAt descending"
          }
        },
        "required": [
          "projectId",
          "cpfs"
        ]
      },
      "ProjectCpfResponse": {
        "type": "object",
        "properties": {
          "cpf": {
            "$ref": "#/components/schemas/ProjectCpf"
          }
        },
        "required": [
          "cpf"
        ]
      },
      "ProjectCpfBatchUpsertResponse": {
        "type": "object",
        "properties": {
          "cpfs": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectCpf"
            },
            "description": "Full records for all successfully upserted entries"
          }
        },
        "required": [
          "cpfs"
        ]
      },
      "ProjectWorkbenchLink": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "casefileId": {
            "type": "string",
            "format": "uuid"
          },
          "linkedAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "lastSyncedAt": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        },
        "required": [
          "projectId",
          "casefileId",
          "linkedAt",
          "updatedAt"
        ]
      },
      "ProjectWorkbenchLinkMutationRequest": {
        "type": "object",
        "properties": {
          "casefileId": {
            "type": "string",
            "format": "uuid"
          }
        },
        "required": [
          "casefileId"
        ]
      },
      "ProjectWorkbenchLinkResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "link": {
            "oneOf": [
              {
                "$ref": "#/components/schemas/ProjectWorkbenchLink"
              },
              {
                "type": "null"
              }
            ]
          },
          "casefile": {
            "oneOf": [
              {
                "type": "object",
                "additionalProperties": true
              },
              {
                "type": "null"
              }
            ]
          }
        },
        "required": [
          "projectId",
          "link",
          "casefile"
        ]
      },
      "ProjectWorkbenchSource": {
        "type": "object",
        "properties": {
          "sourceKey": {
            "type": "string"
          },
          "sourceType": {
            "type": "string"
          },
          "type": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "sourceLabel": {
            "type": "string"
          },
          "referenceUrl": {
            "type": "string"
          },
          "detail": {
            "type": "string"
          }
        },
        "required": [
          "sourceKey",
          "sourceType",
          "type",
          "title"
        ]
      },
      "ProjectWorkbenchSourcesResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "sources": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectWorkbenchSource"
            }
          }
        },
        "required": [
          "projectId",
          "sources"
        ]
      },
      "ProjectWorkbenchSyncSummary": {
        "type": "object",
        "properties": {
          "created": {
            "type": "integer"
          },
          "updated": {
            "type": "integer"
          },
          "deleted": {
            "type": "integer"
          },
          "totalSources": {
            "type": "integer"
          }
        },
        "required": [
          "created",
          "updated",
          "deleted",
          "totalSources"
        ]
      },
      "ProjectWorkbenchSyncResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "link": {
            "$ref": "#/components/schemas/ProjectWorkbenchLink"
          },
          "casefile": {
            "type": "object",
            "additionalProperties": true
          },
          "sync": {
            "$ref": "#/components/schemas/ProjectWorkbenchSyncSummary"
          },
          "sources": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectWorkbenchSource"
            }
          }
        },
        "required": [
          "projectId",
          "link",
          "casefile",
          "sync",
          "sources"
        ]
      },
      "ProjectWorkbenchDeleteResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "deleted": {
            "type": "boolean"
          }
        },
        "required": [
          "projectId",
          "deleted"
        ]
      },
      "GloDocument": {
        "type": "object",
        "required": [
          "title",
          "url",
          "details"
        ],
        "properties": {
          "title": {
            "type": "string"
          },
          "url": {
            "type": "string",
            "format": "uri"
          },
          "details": {
            "type": "string"
          }
        }
      },
      "GloRecordsResponse": {
        "type": "object",
        "required": [
          "address",
          "searchUrl",
          "resultsUrl",
          "documents"
        ],
        "properties": {
          "address": {
            "type": "string"
          },
          "township": {
            "type": "string"
          },
          "townshipDir": {
            "type": "string"
          },
          "range": {
            "type": "string"
          },
          "rangeDir": {
            "type": "string"
          },
          "section": {
            "type": "string"
          },
          "townshipRange": {
            "type": "string"
          },
          "searchUrl": {
            "type": "string",
            "format": "uri"
          },
          "documents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/GloDocument"
            }
          },
          "resultsUrl": {
            "type": "string",
            "format": "uri"
          },
          "location": {
            "type": "object",
            "nullable": true,
            "properties": {
              "lon": {
                "type": "number"
              },
              "lat": {
                "type": "number"
              }
            }
          }
        }
      },
      "ProjectWorkbenchTraverseRecord": {
        "type": "object",
        "properties": {
          "traverseId": {
            "type": "string"
          },
          "casefileId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": [
          "traverseId",
          "casefileId",
          "name",
          "createdAt",
          "updatedAt"
        ]
      },
      "ProjectWorkbenchTraverseListResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "traverses": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectWorkbenchTraverseRecord"
            }
          }
        },
        "required": [
          "projectId",
          "traverses"
        ]
      },
      "ProjectWorkbenchTraverseUpsertRequest": {
        "type": "object",
        "properties": {
          "traverseId": {
            "type": "string"
          },
          "casefileId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "calls": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "bearing": {
                  "type": "string"
                },
                "distance": {
                  "type": "number"
                }
              },
              "required": [
                "bearing",
                "distance"
              ]
            }
          }
        },
        "required": [
          "name",
          "calls"
        ]
      },
      "ProjectWorkbenchTraverseResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "traverseId": {
            "type": "string"
          },
          "casefileId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "traverse": {
            "$ref": "#/components/schemas/BoundaryLabTraverseConfig"
          }
        },
        "required": [
          "projectId",
          "traverseId",
          "casefileId",
          "name",
          "traverse"
        ]
      },
      "ProjectWorkbenchTraverseLoadResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "traverseId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "casefile": {
            "$ref": "#/components/schemas/Casefile"
          },
          "traverse": {
            "$ref": "#/components/schemas/BoundaryLabTraverseConfig"
          }
        },
        "required": [
          "projectId",
          "traverseId",
          "name",
          "casefile",
          "traverse"
        ]
      },
      "BoundaryLabTraverseCall": {
        "type": "object",
        "properties": {
          "bearing": {
            "type": "string"
          },
          "distance": {
            "type": "number"
          }
        },
        "required": [
          "bearing",
          "distance"
        ]
      },
      "BoundaryLabTraverseConfig": {
        "type": "object",
        "properties": {
          "start": {
            "type": "object",
            "properties": {
              "N": {
                "type": "number"
              },
              "E": {
                "type": "number"
              }
            },
            "required": [
              "N",
              "E"
            ]
          },
          "basis": {
            "type": "object",
            "properties": {
              "label": {
                "type": "string"
              },
              "rotationDeg": {
                "type": "number"
              }
            },
            "required": [
              "label",
              "rotationDeg"
            ]
          },
          "calls": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BoundaryLabTraverseCall"
            }
          },
          "lastRun": {
            "type": [
              "string",
              "null"
            ]
          }
        },
        "required": [
          "start",
          "basis",
          "calls"
        ]
      },
      "FieldToFinishSettings": {
        "type": "object",
        "properties": {
          "schemaVersion": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "config": {
            "type": "object",
            "additionalProperties": true
          },
          "symbolSvgOverrides": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": [
          "id",
          "config",
          "symbolSvgOverrides"
        ]
      },
      "FieldToFinishSettingsResponse": {
        "type": "object",
        "properties": {
          "settings": {
            "$ref": "#/components/schemas/FieldToFinishSettings"
          }
        },
        "required": [
          "settings"
        ]
      },
      "FieldToFinishSettingsMutationRequest": {
        "type": "object",
        "properties": {
          "config": {
            "type": "object",
            "additionalProperties": true
          },
          "symbolSvgOverrides": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        },
        "required": [
          "config"
        ]
      },
      "ProjectWorkbenchSyncRequest": {
        "type": "object",
        "description": "Optional controls for casefile creation and synchronization behavior.",
        "properties": {
          "name": {
            "type": "string",
            "description": "Casefile name to use when a new linked casefile is created."
          },
          "initializeDefaults": {
            "type": "boolean",
            "description": "When creating a casefile, set to false to skip default extraction/corner scaffolding.",
            "default": true
          },
          "forceNewCasefile": {
            "type": "boolean",
            "description": "When true, creates a fresh linked casefile before synchronizing sources.",
            "default": false
          }
        },
        "additionalProperties": false
      },
      "LineSmithDrawingPointFileLink": {
        "type": "object",
        "description": "Associates a LineSmith drawing with a project point file. When set, drawing saves synchronize point rows into the linked point file with version history.",
        "properties": {
          "projectId": {
            "type": "string",
            "description": "Project ID that owns the linked point file. Defaults to the drawing project when omitted."
          },
          "pointFileId": {
            "type": "string",
            "description": "Point file identifier to update when drawing points change."
          },
          "pointFileName": {
            "type": "string",
            "description": "Optional display name for the linked point file."
          }
        },
        "required": [
          "pointFileId"
        ],
        "additionalProperties": false
      },
      "ProjectPointFileChangeContext": {
        "type": "object",
        "properties": {
          "app": {
            "type": "string",
            "description": "App/tool identifier recording who made the point-file change (for example pointforge, linesmith-drawing, equipment-log)."
          },
          "user": {
            "type": "string",
            "description": "User identifier/name for the operator who made the change."
          }
        }
      },
      "IdahoHarvestWorkerStatus": {
        "type": "object",
        "properties": {
          "desiredRunning": {
            "type": "boolean"
          },
          "running": {
            "type": "boolean"
          },
          "pid": {
            "type": [
              "integer",
              "null"
            ]
          },
          "restartCount": {
            "type": "integer"
          },
          "lastExitCode": {
            "type": [
              "integer",
              "null"
            ]
          },
          "status": {
            "type": "string"
          }
        },
        "required": [
          "desiredRunning",
          "running",
          "restartCount",
          "status"
        ]
      },
      "IdahoHarvestStatusResponse": {
        "type": "object",
        "properties": {
          "worker": {
            "$ref": "#/components/schemas/IdahoHarvestWorkerStatus"
          }
        },
        "required": [
          "worker"
        ]
      },
      "RecordQuarryCacheInput": {
        "type": "object",
        "description": "Request body for saving a RecordQuarry lookup snapshot.",
        "properties": {
          "address": {
            "type": "string",
            "description": "Normalized address string (lowercased, whitespace-collapsed). Used as the cache key when saving by address."
          },
          "lookup": {
            "type": "object",
            "description": "Full RecordQuarry lookup payload returned by lookupByAddress(). Contains geocode, parcel, ROS, sections, township, utilities, etc.",
            "additionalProperties": true
          },
          "selection": {
            "type": "object",
            "nullable": true,
            "description": "Optional aliquot/parcel selection state snapshot.",
            "properties": {
              "selectedParcel": {
                "type": "boolean"
              },
              "selectedAliquotKeys": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "deselectedAliquotKeys": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "savedAt": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp set by the client when the snapshot was captured. Overwritten by the server on save."
          }
        },
        "required": [
          "lookup"
        ]
      },
      "RecordQuarryCacheRecord": {
        "type": "object",
        "description": "A persisted RecordQuarry lookup snapshot as returned by the server.",
        "properties": {
          "schemaVersion": {
            "type": "string",
            "example": "1.0.0"
          },
          "projectId": {
            "type": "string",
            "nullable": true,
            "description": "Present when the record is keyed by project. Omitted for address-keyed records."
          },
          "address": {
            "type": "string",
            "description": "Normalized address string (lowercased, whitespace-collapsed)."
          },
          "lookup": {
            "type": "object",
            "description": "Full RecordQuarry lookup payload.",
            "additionalProperties": true
          },
          "selection": {
            "type": "object",
            "nullable": true,
            "description": "Aliquot/parcel selection state snapshot, or null if not saved.",
            "properties": {
              "selectedParcel": {
                "type": "boolean"
              },
              "selectedAliquotKeys": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              },
              "deselectedAliquotKeys": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          },
          "savedAt": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp of when this snapshot was last saved on the server."
          }
        },
        "required": [
          "schemaVersion",
          "address",
          "lookup",
          "savedAt"
        ]
      },
      "ProjectPlatSummary": {
        "type": "object",
        "required": [
          "platId",
          "subdivisionName",
          "title",
          "starredInFieldBook",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "platId": {
            "type": "string"
          },
          "subdivisionName": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "source": {
            "type": "string",
            "nullable": true
          },
          "platUrl": {
            "type": "string",
            "nullable": true
          },
          "thumbnailUrl": {
            "type": "string",
            "nullable": true
          },
          "metadata": {
            "type": "object",
            "nullable": true,
            "additionalProperties": true
          },
          "starredInFieldBook": {
            "type": "boolean"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ProjectPlat": {
        "type": "object",
        "required": [
          "schemaVersion",
          "projectId",
          "platId",
          "subdivisionName",
          "title",
          "starredInFieldBook",
          "createdAt",
          "updatedAt"
        ],
        "properties": {
          "schemaVersion": {
            "type": "string"
          },
          "projectId": {
            "type": "string"
          },
          "platId": {
            "type": "string"
          },
          "subdivisionName": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "source": {
            "type": "string",
            "nullable": true
          },
          "platUrl": {
            "type": "string",
            "nullable": true
          },
          "thumbnailUrl": {
            "type": "string",
            "nullable": true
          },
          "metadata": {
            "type": "object",
            "nullable": true,
            "additionalProperties": true
          },
          "starredInFieldBook": {
            "type": "boolean"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ProjectPlatMutationRequest": {
        "type": "object",
        "required": [
          "subdivisionName"
        ],
        "properties": {
          "platId": {
            "type": "string"
          },
          "subdivisionName": {
            "type": "string"
          },
          "title": {
            "type": "string"
          },
          "source": {
            "type": "string"
          },
          "platUrl": {
            "type": "string"
          },
          "thumbnailUrl": {
            "type": "string"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": true
          },
          "starredInFieldBook": {
            "type": "boolean"
          }
        }
      },
      "ProjectPlatBatchUpsertRequest": {
        "type": "object",
        "required": [
          "plats"
        ],
        "properties": {
          "plats": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectPlatMutationRequest"
            }
          }
        }
      },
      "ProjectPlatListResponse": {
        "type": "object",
        "required": [
          "projectId",
          "plats"
        ],
        "properties": {
          "projectId": {
            "type": "string"
          },
          "plats": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectPlatSummary"
            }
          }
        }
      },
      "ProjectPlatResponse": {
        "type": "object",
        "required": [
          "plat"
        ],
        "properties": {
          "plat": {
            "$ref": "#/components/schemas/ProjectPlat"
          }
        }
      },
      "ProjectPlatBatchUpsertResponse": {
        "type": "object",
        "required": [
          "plats"
        ],
        "properties": {
          "plats": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectPlat"
            }
          }
        }
      },
      "ProjectRosSummary": {
        "type": "object",
        "description": "Lightweight ROS summary stored in the project index (returned by list).",
        "properties": {
          "rosId": {
            "type": "string",
            "description": "Slugified rosNumber number (e.g. \"2024-123456\")"
          },
          "rosNumber": {
            "type": "string",
            "description": "Normalized rosNumber number (uppercase)"
          },
          "title": {
            "type": "string",
            "description": "Display title"
          },
          "source": {
            "type": "string",
            "nullable": true,
            "description": "Originating app (e.g. \"RecordQuarry\") or null"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "starredInFieldBook": {
            "type": "boolean",
            "description": "Whether this ROS is starred for field-book print jobs."
          },
          "mapImageUrl": {
            "type": "string",
            "nullable": true,
            "description": "Full-size ROS map image URL when available"
          },
          "metadata": {
            "type": "object",
            "nullable": true,
            "description": "Source-specific ROS metadata exported by RecordQuarry (e.g., source IDs, name, aliquot, geolocation, and source attributes).",
            "additionalProperties": true
          },
          "thumbnailUrl": {
            "type": "string",
            "nullable": true
          }
        },
        "required": [
          "rosId",
          "rosNumber",
          "title",
          "createdAt",
          "updatedAt",
          "starredInFieldBook"
        ]
      },
      "ProjectRos": {
        "type": "object",
        "description": "Full ROS record persisted in the sync snapshot.",
        "properties": {
          "schemaVersion": {
            "type": "string",
            "example": "1.0.0"
          },
          "projectId": {
            "type": "string"
          },
          "rosId": {
            "type": "string",
            "description": "Slugified rosNumber number derived at write time"
          },
          "rosNumber": {
            "type": "string",
            "description": "Normalized rosNumber number (uppercase)"
          },
          "title": {
            "type": "string",
            "description": "Display title (defaults to \"ROS {rosNumber}\")"
          },
          "source": {
            "type": "string",
            "nullable": true,
            "description": "Originating app (e.g. \"RecordQuarry\") or null"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "starredInFieldBook": {
            "type": "boolean",
            "description": "Whether this ROS is starred for field-book print jobs."
          },
          "mapImageUrl": {
            "type": "string",
            "nullable": true,
            "description": "Full-size ROS map image URL when available"
          },
          "metadata": {
            "type": "object",
            "nullable": true,
            "description": "Source-specific ROS metadata exported by RecordQuarry (e.g., source IDs, name, aliquot, geolocation, and source attributes).",
            "additionalProperties": true
          },
          "thumbnailUrl": {
            "type": "string",
            "nullable": true
          }
        },
        "required": [
          "schemaVersion",
          "projectId",
          "rosId",
          "rosNumber",
          "title",
          "createdAt",
          "updatedAt",
          "starredInFieldBook"
        ]
      },
      "ProjectRosMutationRequest": {
        "type": "object",
        "description": "Request body for single ROS create/update (POST without batch, PUT, or PATCH).",
        "properties": {
          "rosNumber": {
            "type": "string",
            "description": "Instrument number. Normalized to uppercase; `rosId` is derived by slugifying this value."
          },
          "title": {
            "type": "string",
            "description": "Display title. Defaults to \"ROS {rosNumber}\" when omitted."
          },
          "source": {
            "type": "string",
            "nullable": true,
            "description": "Originating app label (e.g. \"RecordQuarry\")"
          },
          "starredInFieldBook": {
            "type": "boolean",
            "description": "Whether this ROS is starred for field-book print jobs."
          },
          "mapImageUrl": {
            "type": "string",
            "nullable": true,
            "description": "Full-size ROS map image URL when available"
          },
          "metadata": {
            "type": "object",
            "nullable": true,
            "description": "Source-specific ROS metadata exported by RecordQuarry (e.g., source IDs, name, aliquot, geolocation, and source attributes).",
            "additionalProperties": true
          },
          "thumbnailUrl": {
            "type": "string",
            "nullable": true
          }
        },
        "required": [
          "rosNumber"
        ]
      },
      "ProjectRosBatchUpsertRequest": {
        "type": "object",
        "description": "Request body for atomic batch upsert of multiple ROS records.",
        "properties": {
          "ros": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectRosMutationRequest"
            },
            "description": "Array of ROS entries to upsert. Entries missing `rosNumber` are silently skipped."
          }
        },
        "required": [
          "ros"
        ]
      },
      "ProjectRosListResponse": {
        "type": "object",
        "properties": {
          "projectId": {
            "type": "string"
          },
          "ros": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectRosSummary"
            },
            "description": "ROS summaries sorted by updatedAt descending"
          }
        },
        "required": [
          "projectId",
          "ros"
        ]
      },
      "ProjectRosResponse": {
        "type": "object",
        "properties": {
          "ros": {
            "$ref": "#/components/schemas/ProjectRos"
          }
        },
        "required": [
          "ros"
        ]
      },
      "ProjectRosBatchUpsertResponse": {
        "type": "object",
        "properties": {
          "ros": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProjectRos"
            },
            "description": "Full records for all successfully upserted entries"
          }
        },
        "required": [
          "ros"
        ]
      },
      "HarvestArchivePage": {
        "type": "object",
        "required": [
          "page",
          "fileName",
          "objectKey"
        ],
        "properties": {
          "page": {
            "type": "integer"
          },
          "fileName": {
            "type": "string"
          },
          "objectKey": {
            "type": "string"
          }
        }
      },
      "HarvestArchiveDocument": {
        "type": "object",
        "required": [
          "id",
          "pageCount",
          "pages",
          "pdfUrl"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "pageCount": {
            "type": "integer"
          },
          "pages": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/HarvestArchivePage"
            }
          },
          "pdfUrl": {
            "type": "string"
          }
        }
      }
    }
  }
}
